<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Trust Migration Journey Add-in - User Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        nav {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        nav h2 {
            margin-bottom: 15px;
            color: #0078d4;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        nav a {
            text-decoration: none;
            color: #0078d4;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 4px;
            transition: all 0.3s ease;
            border: 1px solid #e1e1e1;
        }

        nav a:hover {
            background: #0078d4;
            color: white;
        }

        section {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        section h2 {
            color: #0078d4;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #0078d4;
        }

        section h3 {
            color: #106ebe;
            font-size: 1.5em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        section h4 {
            color: #333;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-color: #0c5460;
            color: #0c5460;
        }

        .alert-success {
            background-color: #d4edda;
            border-color: #155724;
            color: #155724;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #856404;
            color: #856404;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table th {
            background: #0078d4;
            color: white;
            padding: 12px;
            text-align: left;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #e1e1e1;
        }

        table tr:hover {
            background: #f5f5f5;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
        }

        .emoji {
            font-size: 1.2em;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: #666;
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            nav ul {
                flex-direction: column;
                gap: 10px;
            }

            section {
                padding: 20px;
            }

            table {
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Zero Trust Migration Journey Add-in</h1>
            <p>User Guide - ConfigMgr to Intune Migration Dashboard</p>
        </header>

        <nav>
            <h2>Quick Navigation</h2>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#requirements">Requirements</a></li>
                <li><a href="#installation">Installation</a></li>
                <li><a href="#auto-updates">Automatic Updates</a></li>
                <li><a href="#enrollment">Device Enrollment</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
                <li><a href="#faq">FAQ</a></li>
            </ul>
        </nav>

        <!-- Overview Section -->
        <section id="overview">
            <h2><span class="emoji">üéØ</span> Overview</h2>
            
            <div class="alert alert-success">
                <strong>üéâ Version 3.16.19 - January 15, 2026</strong>
                <ul>
                    <li>Version update</li>
                </ul>
            </div>

            <h3>What is the Zero Trust Migration Journey Add-in?</h3>
            <p>The Zero Trust Migration Journey Add-in is a Windows desktop dashboard that helps IT teams visualize and manage their ConfigMgr to Microsoft Intune migration. It connects to your Microsoft Graph and ConfigMgr environment to provide real-time insights on device enrollment progress and health.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Real-Time Data:</strong> Connects to Microsoft Graph to pull actual device enrollment data</li>
                <li><strong>Enrollment Tracking:</strong> Visualize enrollment progress with charts and metrics</li>
                <li><strong>Device Health Monitoring:</strong> Track device readiness and identify issues</li>
                <li><strong>Automatic Updates:</strong> Self-updating application ensures you always have the latest features</li>
                <li><strong>Privacy-Safe Telemetry:</strong> Anonymous usage analytics help improve the tool</li>
            </ul>

            <h3>Current Focus: Enrollment Dashboard</h3>
            <p>This release focuses on the <strong>Overview</strong> and <strong>Enrollment</strong> tabs, providing:</p>
            <ul>
                <li>Total device count from your environment</li>
                <li>Enrolled device tracking (Intune-managed devices)</li>
                <li>Enrollment percentage and trends</li>
                <li>Visual charts showing progress over time</li>
                <li>Device health scores and readiness metrics</li>
            </ul>
        </section>

        <!-- Requirements Section -->
        <section id="requirements">
            <h2><span class="emoji">‚öôÔ∏è</span> Access Requirements</h2>

            <h3>System Requirements</h3>
            <table>
                <thead>
                    <tr>
                        <th>Requirement</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Operating System</strong></td>
                        <td>Windows 10/11 (x64)</td>
                    </tr>
                    <tr>
                        <td><strong>Internet Connection</strong></td>
                        <td>Required for Microsoft Graph and auto-updates</td>
                    </tr>
                    <tr>
                        <td><strong>.NET Runtime</strong></td>
                        <td>Included in package (no separate install needed)</td>
                    </tr>
                    <tr>
                        <td><strong>Disk Space</strong></td>
                        <td>~150 MB</td>
                    </tr>
                </tbody>
            </table>

            <h3>Microsoft Graph Permissions</h3>
            <p>To connect to Microsoft Graph and pull device data, you need one of these roles:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Azure AD Role</th>
                        <th>What It Can Do</th>
                        <th>Recommended For</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Global Administrator</strong></td>
                        <td>Full access to all features</td>
                        <td>Testing & setup</td>
                    </tr>
                    <tr>
                        <td><strong>Intune Administrator</strong></td>
                        <td>Read device data, enrollment status</td>
                        <td>Daily usage (recommended)</td>
                    </tr>
                    <tr>
                        <td><strong>Cloud Device Administrator</strong></td>
                        <td>Read device data</td>
                        <td>Read-only access</td>
                    </tr>
                    <tr>
                        <td><strong>Reports Reader</strong></td>
                        <td>View reports and basic device data</td>
                        <td>Viewing dashboards only</td>
                    </tr>
                </tbody>
            </table>

            <div class="alert alert-info">
                <strong>üí° Tip:</strong> If you can access the Intune portal at <code>endpoint.microsoft.com</code>, you likely have the required permissions to use this tool.
            </div>

            <h3>ConfigMgr Admin Service (Optional)</h3>
            <p>For ConfigMgr integration, you need:</p>
            <ul>
                <li><strong>ConfigMgr Admin Service enabled</strong> on your site server</li>
                <li><strong>Full Administrator</strong> role in ConfigMgr (or equivalent read permissions)</li>
                <li><strong>Network access</strong> to your ConfigMgr Admin Service endpoint</li>
            </ul>

            <div class="alert alert-warning">
                <strong>Note:</strong> If you don't have ConfigMgr access, you can use the tool with Microsoft Graph only or switch to Mock Data mode for testing.
            </div>
        </section>

        <!-- Installation Section -->
        <section id="installation">
            <h2><span class="emoji">üì•</span> Installation</h2>

            <h3>Quick Install</h3>
            <ol>
                <li><strong>Download</strong> the latest release from GitHub:
                    <pre><code>https://github.com/sccmavenger/cmaddin/releases/latest</code></pre>
                </li>
                <li><strong>Extract</strong> the ZIP file to a folder (e.g., <code>C:\ZeroTrustMigrationAddin</code>)</li>
                <li><strong>Run</strong> <code>ZeroTrustMigrationAddin.exe</code></li>
                <li><strong>Authenticate</strong> with your Microsoft 365 account when prompted</li>
            </ol>

            <h3>First Launch</h3>
            <p>When you launch the app for the first time:</p>
            <ol>
                <li>The app checks for updates (takes 2-4 seconds)</li>
                <li>You'll see the main dashboard with a login prompt</li>
                <li>Click <strong>"Connect to Microsoft Graph"</strong></li>
                <li>Sign in with your Microsoft 365 admin account</li>
                <li>Grant the requested permissions (Device.Read.All, User.Read)</li>
                <li>The dashboard will load your device data</li>
            </ol>

            <div class="alert alert-success">
                <strong>üéâ Version 3.16.19 - January 15, 2026</strong>
                <ul>
                    <li>Version update</li>
                </ul>
            </div>
        </section>

        <!-- Automatic Updates Section -->
        <section id="auto-updates">
            <h2><span class="emoji">üöÄ</span> Automatic Updates</h2>

            <h3>How It Works</h3>
            <p>The Zero Trust Migration Journey Add-in updates itself automatically - no manual downloads or IT deployment needed:</p>

            <table>
                <thead>
                    <tr>
                        <th>Stage</th>
                        <th>What Happens</th>
                        <th>Duration</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>1. Check for Updates</strong></td>
                        <td>Every launch, checks GitHub for newer versions</td>
                        <td>2-4 seconds</td>
                    </tr>
                    <tr>
                        <td><strong>2. Download Delta</strong></td>
                        <td>Only downloads changed files (80-90% bandwidth savings)</td>
                        <td>20-30 seconds</td>
                    </tr>
                    <tr>
                        <td><strong>3. UAC Prompt</strong></td>
                        <td>Windows requests admin elevation to update files</td>
                        <td>Click "Yes"</td>
                    </tr>
                    <tr>
                        <td><strong>4. Apply Update</strong></td>
                        <td>Files replaced automatically in background</td>
                        <td>5-10 seconds</td>
                    </tr>
                    <tr>
                        <td><strong>5. Restart</strong></td>
                        <td>App relaunches with new version</td>
                        <td>Immediate</td>
                    </tr>
                </tbody>
            </table>

            <h3>Common Questions</h3>

            <h4>Why do I see a UAC prompt?</h4>
            <p>The app is installed in Program Files, which requires administrator privileges to modify. This is standard Windows security - the same prompt you see when updating Chrome, VS Code, or other apps.</p>

            <h4>What if I click "No" on the UAC prompt?</h4>
            <p>The update won't install and you'll continue using the current version. The update will be offered again next time you launch the app.</p>

            <h4>What if I'm offline?</h4>
            <p>The update check will timeout after 10 seconds and the app will continue loading with your current version. No errors or delays.</p>

            <h4>Can I disable updates?</h4>
            <p>Updates are always enabled to ensure you have the latest security fixes and features. The process is fast (30-45 seconds) and only happens when launching.</p>
        </section>

        <!-- Enrollment Section -->
        <section id="enrollment">
            <h2><span class="emoji">üíª</span> Device Enrollment & Trends</h2>

            <h3>What You'll See</h3>
            <p>The Enrollment tab provides a comprehensive view of your Intune device enrollment progress:</p>

            <h4>Key Metrics</h4>
            <ul>
                <li><strong>Total Devices:</strong> Complete device count from Microsoft Graph</li>
                <li><strong>Enrolled Devices:</strong> Number of devices managed by Intune</li>
                <li><strong>Enrollment Percentage:</strong> Progress toward full cloud management</li>
                <li><strong>Trend Analysis:</strong> Enrollment velocity over time</li>
            </ul>

            <h4>Visual Charts</h4>
            <ul>
                <li><strong>Enrollment Progress:</strong> Pie/donut chart showing enrolled vs. not enrolled</li>
                <li><strong>Trend Line:</strong> Historical enrollment growth over 30/60/90 days</li>
                <li><strong>Device Health:</strong> Health score distribution across your fleet</li>
            </ul>

            <h3>Data Sources</h3>
            <p>The enrollment data comes from:</p>
            <table>
                <thead>
                    <tr>
                        <th>Data Point</th>
                        <th>Source</th>
                        <th>Graph API Endpoint</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Total Devices</td>
                        <td>Microsoft Graph</td>
                        <td><code>/devices</code></td>
                    </tr>
                    <tr>
                        <td>Enrolled Devices</td>
                        <td>Microsoft Graph</td>
                        <td><code>/deviceManagement/managedDevices</code></td>
                    </tr>
                    <tr>
                        <td>Enrollment Date</td>
                        <td>Intune</td>
                        <td><code>enrolledDateTime</code> property</td>
                    </tr>
                    <tr>
                        <td>Device Health</td>
                        <td>Calculated</td>
                        <td>Based on compliance state + last sync</td>
                    </tr>
                </tbody>
            </table>

            <h3>Interpreting the Data</h3>

            <h4>Enrollment Percentage</h4>
            <p><strong>Formula:</strong> (Enrolled Devices √∑ Total Devices) √ó 100</p>
            <ul>
                <li><strong>0-25%:</strong> Early migration phase - just getting started</li>
                <li><strong>25-50%:</strong> Active migration - pilot groups enrolled</li>
                <li><strong>50-75%:</strong> Majority migrated - focus on stragglers</li>
                <li><strong>75-100%:</strong> Near completion - final wave</li>
            </ul>

            <h4>Device Health Scores</h4>
            <ul>
                <li><strong>90-100:</strong> Healthy - compliant, syncing regularly</li>
                <li><strong>70-89:</strong> Good - minor issues, generally working</li>
                <li><strong>50-69:</strong> Fair - some compliance/sync issues</li>
                <li><strong>Below 50:</strong> Poor - needs attention</li>
            </ul>

            <div class="alert alert-info">
                <strong>üí° Tip:</strong> Use the trend chart to identify enrollment velocity. If enrollment has stalled, you may need to communicate with users or adjust your deployment strategy.
            </div>
        </section>

        <!-- Troubleshooting Section -->
        <section id="troubleshooting">
            <h2><span class="emoji">üîß</span> Troubleshooting</h2>

            <h3>Common Issues</h3>

            <h4>Issue: "Can't connect to Microsoft Graph"</h4>
            <p><strong>Possible Causes:</strong></p>
            <ul>
                <li>Insufficient Azure AD permissions</li>
                <li>Network firewall blocking <code>graph.microsoft.com</code></li>
                <li>Expired authentication token</li>
            </ul>
            <p><strong>Solutions:</strong></p>
            <ol>
                <li>Verify you have Intune Administrator or higher role</li>
                <li>Check firewall allows HTTPS to <code>*.microsoft.com</code></li>
                <li>Click "Connect to Microsoft Graph" to re-authenticate</li>
            </ol>

            <h4>Issue: App won't launch</h4>
            <p><strong>Solutions:</strong></p>
            <ol>
                <li>Check Windows Event Viewer for .NET errors</li>
                <li>Ensure .NET 8 runtime isn't blocked by Group Policy</li>
                <li>Try running as administrator</li>
                <li>Check logs in <code>%LOCALAPPDATA%\ZeroTrustMigrationAddin\Logs\</code></li>
            </ol>

            <h4>Issue: Update fails with "Access Denied"</h4>
            <p><strong>Solutions:</strong></p>
            <ol>
                <li>Make sure you click "Yes" on the UAC prompt</li>
                <li>Check you have write permissions to the install folder</li>
                <li>Close any antivirus that might be blocking file updates</li>
            </ol>

            <h4>Issue: Data looks incorrect</h4>
            <p><strong>Solutions:</strong></p>
            <ol>
                <li>Click the refresh button to reload data</li>
                <li>Verify device counts match Intune portal</li>
                <li>Check if you're in Mock Data mode (status bar shows data source)</li>
            </ol>

            <h3>Diagnostic Logs</h3>
            <p>Logs are stored in:</p>
            <pre><code>%LOCALAPPDATA%\ZeroTrustMigrationAddin\Logs\ZeroTrustMigrationAddin_YYYYMMDD.log</code></pre>

            <p>Log files include:</p>
            <ul>
                <li><strong>[INFO]</strong> - General operations and status</li>
                <li><strong>[WARNING]</strong> - Non-critical issues</li>
                <li><strong>[ERROR]</strong> - Failed operations</li>
                <li><strong>[TELEMETRY]</strong> - Anonymous usage events</li>
            </ul>

            <div class="alert alert-info">
                <strong>üí° Need Help?</strong> When reporting issues, include:
                <ul>
                    <li>Last 30-50 lines from the log file (remove sensitive info)</li>
                    <li>App version (shown in About window)</li>
                    <li>Steps to reproduce the issue</li>
                </ul>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq">
            <h2><span class="emoji">‚ùì</span> Frequently Asked Questions</h2>

            <h4>Q: Is this tool officially from Microsoft?</h4>
            <p><strong>A:</strong> No, this is a community tool built to help IT teams manage their ConfigMgr to Intune migrations. It uses official Microsoft Graph APIs to pull data.</p>

            <h4>Q: What data does telemetry collect?</h4>
            <p><strong>A:</strong> We collect anonymous usage analytics (which buttons you click, errors that occur) to improve the tool. We DO NOT collect usernames, device names, tenant IDs, emails, IPs, or any identifiable information. All PII is automatically sanitized before sending to Azure.</p>

            <h4>Q: Can I use this in production?</h4>
            <p><strong>A:</strong> The tool reads data only - it doesn't modify your Intune or ConfigMgr environment. It's safe to use in production for monitoring purposes.</p>

            <h4>Q: How often does data refresh?</h4>
            <p><strong>A:</strong> Data refreshes when you click the refresh button or switch between data sources. The Microsoft Graph data is real-time.</p>

            <h4>Q: Why do I need admin permissions for updates?</h4>
            <p><strong>A:</strong> The app is installed in Program Files, which is protected by Windows. Admin elevation is required to modify files in that location - this is standard security practice.</p>

            <h4>Q: What happens to ConfigMgr integration?</h4>
            <p><strong>A:</strong> ConfigMgr integration is optional. You can connect to ConfigMgr Admin Service if available, or use Microsoft Graph only. Mock Data mode is also available for testing.</p>

            <h4>Q: How do I export device lists?</h4>
            <p><strong>A:</strong> Most data grids have an "Export to CSV" button in the top-right corner. Click it to save the current data to a CSV file.</p>

            <h4>Q: Where are my Graph tokens stored?</h4>
            <p><strong>A:</strong> Authentication tokens are managed by MSAL (Microsoft Authentication Library) and stored securely in Windows Credential Manager. They're never written to log files.</p>

            <h4>Q: Can I deploy this via Intune/SCCM?</h4>
            <p><strong>A:</strong> Not recommended. The tool updates itself automatically from GitHub. Simply share the download link with users - they'll always have the latest version via auto-update.</p>
        </section>

        <footer>
            <p>Zero Trust Migration Journey Add-in v3.16.19 | <a href="https://github.com/sccmavenger/cmaddin" style="color: #0078d4;">GitHub Repository</a></p>
            <p>¬© 2026 | For ConfigMgr and Intune administrators</p>
        </footer>
    </div>
</body>
</html>

