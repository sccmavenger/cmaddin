{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# ðŸ“Š Cloud Journey Add-in - Telemetry Dashboard\n\n**Application Insights Resource:** `appi-cloudjourney-addin`\n\nThis workbook provides comprehensive insights into app deployment, usage patterns, and health metrics.\n\n---"
      },
      "name": "header"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "a2b5c6d7-e8f9-0123-4567-89abcdef0123",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 604800000
            },
            "typeSettings": {
              "selectableValues": [
                { "durationMs": 86400000 },
                { "durationMs": 604800000 },
                { "durationMs": 2592000000 },
                { "durationMs": 7776000000 }
              ],
              "allowCustom": true
            },
            "label": "Time Range"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸ“ˆ Executive Summary"
      },
      "name": "section-executive"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == \"AppStarted\"\n| summarize TotalLaunches = count(), UniqueUsers = dcount(user_Id), UniqueSessions = dcount(session_Id)",
        "size": 4,
        "title": "App Usage (Selected Period)",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": true,
          "titleContent": {
            "columnMatch": "TotalLaunches",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            }
          },
          "leftContent": {
            "columnMatch": "TotalLaunches",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "style": "decimal",
                "maximumFractionDigits": 0
              }
            }
          }
        }
      },
      "name": "kpi-usage"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "exceptions\n| where timestamp {TimeRange}\n| summarize TotalErrors = count(), AffectedUsers = dcount(user_Id)",
        "size": 4,
        "title": "Error Summary",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": true
        }
      },
      "name": "kpi-errors"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸ‘¥ User Adoption"
      },
      "name": "section-adoption"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp > ago(90d)\n| where name == \"AppStarted\"\n| summarize DAU = dcount(user_Id), Launches = count() by bin(timestamp, 1d)\n| order by timestamp asc",
        "size": 0,
        "title": "ðŸ“ˆ Daily Active Users (90 Days)",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "timechart"
      },
      "customWidth": "50",
      "name": "dau-chart"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp > ago(90d)\n| where name == \"AppStarted\"\n| summarize WAU = dcount(user_Id) by bin(timestamp, 7d)\n| order by timestamp asc",
        "size": 0,
        "title": "ðŸ“Š Weekly Active Users (90 Days)",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "timechart"
      },
      "customWidth": "50",
      "name": "wau-chart"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸ“¦ Version Analytics"
      },
      "name": "section-versions"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == \"AppStarted\"\n| extend Version = tostring(customDimensions.Version)\n| summarize Users = dcount(user_Id), Launches = count() by Version\n| order by Launches desc",
        "size": 0,
        "title": "ðŸ“Š Version Distribution",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "version-pie"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp > ago(30d)\n| where name == \"AppStarted\"\n| extend Version = tostring(customDimensions.Version)\n| summarize Users = dcount(user_Id) by bin(timestamp, 1d), Version\n| order by timestamp asc",
        "size": 0,
        "title": "ðŸ“ˆ Version Adoption Over Time",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "timechart"
      },
      "customWidth": "50",
      "name": "version-timeline"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name in (\"UpdateCheckStarted\", \"UpdateCheckSuccess\", \"UpdateDetected\", \"UpdateApplied\", \"UpdateCheckFailed\")\n| summarize Count = count() by name\n| order by Count desc",
        "size": 0,
        "title": "ðŸ”„ Auto-Update Events",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart"
      },
      "customWidth": "50",
      "name": "update-funnel"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == \"UpdateCheckFailed\"\n| extend ErrorType = tostring(customDimensions.ErrorType), Message = tostring(customDimensions.Message)\n| summarize Count = count(), Users = dcount(user_Id) by ErrorType, Message\n| order by Count desc",
        "size": 0,
        "title": "âŒ Update Failures",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table"
      },
      "customWidth": "50",
      "name": "update-failures"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸŽ¯ Feature Usage"
      },
      "name": "section-features"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name !in (\"AppStarted\", \"AppExited\", \"UpdateCheckStarted\", \"UpdateCheckSuccess\", \"UpdateCheckFailed\")\n| summarize UsageCount = count(), UniqueUsers = dcount(user_Id) by name\n| order by UsageCount desc\n| take 15",
        "size": 0,
        "title": "ðŸ“Š Feature Usage Ranking",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart"
      },
      "customWidth": "50",
      "name": "feature-usage"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == \"AppStarted\"\n| extend Hour = hourofday(timestamp)\n| summarize Launches = count() by Hour\n| order by Hour asc",
        "size": 0,
        "title": "â° Peak Usage Hours",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart"
      },
      "customWidth": "50",
      "name": "peak-hours"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸš¨ Errors & Health"
      },
      "name": "section-errors"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "exceptions\n| where timestamp > ago(30d)\n| summarize Errors = count(), AffectedUsers = dcount(user_Id) by bin(timestamp, 1d)\n| order by timestamp asc",
        "size": 0,
        "title": "ðŸ“‰ Error Trend (30 Days)",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "areachart"
      },
      "customWidth": "50",
      "name": "error-trend"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "exceptions\n| where timestamp {TimeRange}\n| summarize ErrorCount = count(), AffectedUsers = dcount(user_Id) by type\n| order by ErrorCount desc",
        "size": 0,
        "title": "ðŸ”¥ Errors by Type",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "piechart"
      },
      "customWidth": "50",
      "name": "error-breakdown"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "exceptions\n| where timestamp {TimeRange}\n| summarize Count = count(), Users = dcount(user_Id), Latest = max(timestamp) by type, outerMessage\n| top 10 by Count\n| project Type = type, Message = substring(outerMessage, 0, 80), Count, Users, Latest",
        "size": 0,
        "title": "ðŸ”Ÿ Top 10 Errors",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table"
      },
      "name": "top-errors"
    },
    {
      "type": 1,
      "content": {
        "json": "## ðŸ‘¤ User Details"
      },
      "name": "section-users"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp > ago(30d)\n| where name == \"AppStarted\"\n| extend Version = tostring(customDimensions.Version)\n| summarize FirstSeen = min(timestamp), LastSeen = max(timestamp), Sessions = count() by user_Id, Version\n| order by LastSeen desc\n| take 50",
        "size": 0,
        "title": "ðŸ‘¥ User Activity",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table"
      },
      "name": "user-details"
    },
    {
      "type": 1,
      "content": {
        "json": "---\n**Dashboard Version:** 1.0 | **Data Source:** Azure Application Insights"
      },
      "name": "footer"
    }
  ],
  "fallbackResourceIds": [],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
