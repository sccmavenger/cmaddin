<Window x:Class="CloudJourneyAddin.Views.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        xmlns:converters="clr-namespace:CloudJourneyAddin.Converters"
        Title="Cloud Journey Progress Dashboard v2.4.0" 
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <converters:PercentageConverter x:Key="PercentageConverter"/>
        <converters:CurrencyConverter x:Key="CurrencyConverter"/>
        <converters:WorkloadStatusConverter x:Key="WorkloadStatusConverter"/>
        <converters:AlertSeverityConverter x:Key="AlertSeverityConverter"/>
        <converters:BlockerSeverityConverter x:Key="BlockerSeverityConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter"/>
        <converters:ObjectToVisibilityConverter x:Key="ObjectToVisibilityConverter"/>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
        <converters:CollectionToVisibilityConverter x:Key="CollectionToVisibilityConverter"/>
        <converters:RecommendationPriorityConverter x:Key="RecommendationPriorityConverter"/>
        <converters:PercentageToStrokeDashConverter x:Key="PercentageToStrokeDashConverter"/>
        <converters:PercentageToWidthConverter x:Key="PercentageToWidthConverter"/>

        <Style x:Key="SectionCard" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SectionTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
        </Style>

        <Style x:Key="MetricLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#666666"/>
        </Style>

        <Style x:Key="MetricValue" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#0078D4"/>
        </Style>

        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#106EBE"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Toggle Switch Style for Autonomous Mode -->
        <Style x:Key="ToggleSwitchStyle" TargetType="ToggleButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="Border" Background="#CCCCCC" CornerRadius="13" Width="50" Height="26">
                            <Ellipse x:Name="Thumb" Fill="White" Width="20" Height="20" 
                                     HorizontalAlignment="Left" Margin="3,0,0,0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#107C10"/>
                                <Setter TargetName="Thumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="Thumb" Property="Margin" Value="0,0,3,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#0078D4" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Cloud Journey Progress" FontSize="28" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Track your migration from ConfigMgr to Microsoft Intune" 
                               FontSize="14" Foreground="#E0E0E0" Margin="0,5,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="ðŸ”— Graph" 
                                Command="{Binding ConnectToGraphCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#107C10"
                                Visibility="{Binding UseRealData, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}"
                                ToolTip="Connect to Microsoft Graph"
                                Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="ï¿½ Diagnostics" 
                                Command="{Binding ShowDiagnosticsCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#FF8C00"
                                ToolTip="Show connection status and data sources"
                                Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="ðŸ¤– AI" 
                                Command="{Binding ShowAISettingsCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#9B59B6"
                                ToolTip="Configure Azure OpenAI integration"
                                Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="ðŸ“‹ Logs" 
                                Command="{Binding OpenLogFolderCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#6C757D"
                                ToolTip="Open log folder with debug information"
                                Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="ðŸ“– Guide" 
                                Command="{Binding OpenUserGuideCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#5C2D91"
                                ToolTip="Open user guide and documentation"
                                Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="ï¿½ðŸ”„ Refresh" 
                                Command="{Binding RefreshCommand}"
                                Style="{StaticResource ActionButton}"
                                Background="#106EBE"
                                ToolTip="Refresh all data"
                                Margin="0,0,0,0" Padding="10,5"/>
                    </WrapPanel>
                    <TextBlock Text="{Binding LastRefreshTime, StringFormat='Last updated: {0:g}'}" 
                               FontSize="11" Foreground="#E0E0E0" 
                               HorizontalAlignment="Right" Margin="0,5,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content with Tabs -->
        <Grid Grid.Row="1">
            <TabControl Margin="10" Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Padding" Value="20,10"/>
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Border Name="Border" 
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="#0078D4"
                                            BorderThickness="0,0,0,3"
                                            Padding="{TemplateBinding Padding}"
                                            Margin="5,0">
                                        <ContentPresenter ContentSource="Header"
                                                          HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#F0F8FF"/>
                                            <Setter TargetName="Border" Property="BorderBrush" Value="#0078D4"/>
                                            <Setter Property="Foreground" Value="#0078D4"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#F9F9F9"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </TabControl.Resources>

                <!-- OVERVIEW TAB (All existing content) -->
                <TabItem Header="ðŸ“Š Overview">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <StackPanel>
                            <!-- Loading Indicator -->
                            <Border Background="#FFF9E6" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                    Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="â³ Loading dashboard data..." FontSize="14" Foreground="#856404"/>
                            </Border>

                            <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Column -->
                    <StackPanel Grid.Column="0">
                        <!-- 1. Overall Migration Status -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“Š Overall Migration Status" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Workloads Transitioned" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Style="{StaticResource MetricValue}">
                                            <Run Text="{Binding MigrationStatus.WorkloadsTransitioned, Mode=OneWay}"/>
                                            <Run Text=" of " FontSize="16"/>
                                            <Run Text="{Binding MigrationStatus.TotalWorkloads, Mode=OneWay}"/>
                                        </TextBlock>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Completion" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding MigrationStatus.CompletionPercentage, Mode=OneWay, Converter={StaticResource PercentageConverter}}" 
                                                   Style="{StaticResource MetricValue}"/>
                                    </StackPanel>
                                </Grid>

                                <ProgressBar Height="20" 
                                             Value="{Binding MigrationStatus.CompletionPercentage, Mode=OneWay}" 
                                             Maximum="100"
                                             Foreground="#0078D4"
                                             Background="#E0E0E0"
                                             Margin="0,0,0,10"/>

                                <TextBlock Text="{Binding MigrationStatus.ProjectedFinishDate, StringFormat='Projected finish: {0:MMMM yyyy}'}" 
                                           FontSize="13" Foreground="#666666"/>
                            </StackPanel>
                        </Border>

                        <!-- 2. Device Enrollment -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="ðŸ’» Device Enrollment" Style="{StaticResource SectionTitle}"/>
                                    <Border Background="#0078D4" CornerRadius="3" Padding="5,2" Margin="10,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="WINDOWS 10/11 ONLY" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Total Windows 10/11" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding DeviceEnrollment.TotalDevices}" 
                                                   Style="{StaticResource MetricValue}" FontSize="20"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Intune Enrolled" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding DeviceEnrollment.IntuneEnrolledDevices}" 
                                                   Style="{StaticResource MetricValue}" FontSize="20" Foreground="#107C10"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="ConfigMgr Only" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding DeviceEnrollment.ConfigMgrOnlyDevices}" 
                                                   Style="{StaticResource MetricValue}" FontSize="20" Foreground="#D13438"/>
                                    </StackPanel>
                                </Grid>

                                <TextBlock Text="Enrollment Trend (6 Months)" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                <lvc:CartesianChart Height="250" Series="{Binding EnrollmentTrendSeries}" 
                                                    LegendLocation="Bottom">
                                    <lvc:CartesianChart.AxisX>
                                        <lvc:Axis Labels="{Binding EnrollmentTrendLabels}"/>
                                    </lvc:CartesianChart.AxisX>
                                    <lvc:CartesianChart.AxisY>
                                        <lvc:Axis Title="Windows 10/11 Devices"/>
                                    </lvc:CartesianChart.AxisY>
                                </lvc:CartesianChart>
                            </StackPanel>
                        </Border>

                        <!-- 3a. Generate Migration Plan Prompt (shows when no plan exists) -->
                        <Border Style="{StaticResource SectionCard}"
                                Background="#F0F8FF"
                                Visibility="{Binding MigrationPlan, Converter={StaticResource NullToVisibilityConverter}}">
                            <StackPanel HorizontalAlignment="Center" Margin="30">
                                <TextBlock Text="ðŸ—“ï¸ Migration Plan Timeline" 
                                           Style="{StaticResource SectionTitle}" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Generate an Autopatch-style migration plan with phased enrollment" 
                                           FontSize="14" 
                                           Foreground="#666" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,20"/>
                                <Button Content="ðŸ“… Generate Migration Plan"
                                        Command="{Binding GenerateMigrationPlanCommand}"
                                        Style="{StaticResource ActionButton}"
                                        FontSize="14"
                                        Padding="20,10"
                                        HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- 3b. Migration Plan Timeline (Phase 1 AI) - shows when plan exists -->
                        <Border Style="{StaticResource SectionCard}"
                                Visibility="{Binding MigrationPlan, Converter={StaticResource ObjectToVisibilityConverter}}">
                            <StackPanel>
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Text="ðŸ—“ï¸ Migration Plan Timeline" Style="{StaticResource SectionTitle}" Margin="0"/>
                                    <Button Grid.Column="1" 
                                            Content="Mark Phase Complete"
                                            Command="{Binding MarkPhaseCompleteCommand}"
                                            Style="{StaticResource ActionButton}"
                                            Background="#107C10"
                                            FontSize="12"
                                            Padding="10,5"
                                            Visibility="{Binding MigrationPlan.CurrentPhaseIndex, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=GreaterThanMinusOne}"/>
                                </Grid>

                                <!-- Plan Summary -->
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Target Date" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding MigrationPlan.TargetDate, StringFormat='{}{0:MMM dd, yyyy}'}" 
                                                   FontSize="16" FontWeight="SemiBold" Foreground="#0078D4"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Overall Progress" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding MigrationPlan.OverallProgress, StringFormat='{}{0:F0}%'}" 
                                                   FontSize="16" FontWeight="SemiBold" Foreground="#0078D4"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Status" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding MigrationPlan.TimelineStatus}" 
                                                   FontSize="16" FontWeight="SemiBold">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#107C10"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding MigrationPlan.TimelineStatus}" Value="Behind Schedule">
                                                            <Setter Property="Foreground" Value="#D13438"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding MigrationPlan.TimelineStatus}" Value="Complete">
                                                            <Setter Property="Foreground" Value="#107C10"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                </Grid>

                                <!-- Phases List -->
                                <ItemsControl ItemsSource="{Binding MigrationPlan.Phases}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="6" 
                                                    Padding="15" Margin="0,0,0,15">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="White"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                                <Setter Property="Background" Value="#E3F2FD"/>
                                                                <Setter Property="BorderBrush" Value="#0078D4"/>
                                                                <Setter Property="BorderThickness" Value="2"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding IsComplete}" Value="True">
                                                                <Setter Property="Background" Value="#F1F8F4"/>
                                                                <Setter Property="BorderBrush" Value="#107C10"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding IsPastDue}" Value="True">
                                                                <Setter Property="Background" Value="#FFF4F4"/>
                                                                <Setter Property="BorderBrush" Value="#D13438"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>

                                                <StackPanel>
                                                    <!-- Phase Header -->
                                                    <Grid Margin="0,0,0,10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock FontWeight="Bold" FontSize="14">
                                                                <Run Text="ðŸ“… Phase"/>
                                                                <Run Text="{Binding PhaseNumber}"/>
                                                                <Run Text=":"/>
                                                                <Run Text="{Binding Name}"/>
                                                            </TextBlock>
                                                            <TextBlock FontSize="12" Foreground="#666666" Margin="0,2,0,0">
                                                                <Run Text="{Binding StartDate, StringFormat='{}{0:MMM dd}'}"/>
                                                                <Run Text=" - "/>
                                                                <Run Text="{Binding EndDate, StringFormat='{}{0:MMM dd}'}"/>
                                                                <Run Text=" â€¢ "/>
                                                                <Run Text="{Binding DeviceCount}"/>
                                                                <Run Text=" devices"/>
                                                            </TextBlock>
                                                        </StackPanel>

                                                        <Border Grid.Column="1" CornerRadius="12" Padding="8,4" VerticalAlignment="Top">
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Setter Property="Background" Value="#E0E0E0"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                                            <Setter Property="Background" Value="#0078D4"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsComplete}" Value="True">
                                                                            <Setter Property="Background" Value="#107C10"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding IsPastDue}" Value="True">
                                                                            <Setter Property="Background" Value="#D13438"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                            <TextBlock FontSize="11" FontWeight="SemiBold" Foreground="White">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Text" Value="Upcoming"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                                                <Setter Property="Text">
                                                                                    <Setter.Value>
                                                                                        <MultiBinding StringFormat="Active â€¢ {0} days left">
                                                                                            <Binding Path="DaysRemaining"/>
                                                                                        </MultiBinding>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding IsComplete}" Value="True">
                                                                                <Setter Property="Text" Value="âœ“ Complete"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding IsPastDue}" Value="True">
                                                                                <Setter Property="Text" Value="âš  Past Due"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Border>
                                                    </Grid>

                                                    <!-- Tasks -->
                                                    <TextBlock Text="Weekly Tasks:" FontWeight="SemiBold" FontSize="12" 
                                                               Margin="0,5,0,5"/>
                                                    <ItemsControl ItemsSource="{Binding Tasks}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock FontSize="12" Margin="0,2,0,2">
                                                                    <Run Text="â€¢" Foreground="#0078D4"/>
                                                                    <Run Text="{Binding Mode=OneWay}"/>
                                                                </TextBlock>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Success Criteria -->
                                                    <Border Background="#FFFBEB" BorderBrush="#FDB813" BorderThickness="1" 
                                                            CornerRadius="4" Padding="8" Margin="0,10,0,0">
                                                        <TextBlock FontSize="12">
                                                            <Run Text="ðŸŽ¯ Success:" FontWeight="SemiBold"/>
                                                            <Run Text="{Binding SuccessCriteria}"/>
                                                        </TextBlock>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 4. Device Selection Intelligence (Phase 1 AI) -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸŽ¯ Device Selection Intelligence" Style="{StaticResource SectionTitle}"/>
                                <TextBlock Text="AI-recommended enrollment batches based on readiness scores" 
                                           FontSize="12" Foreground="#666666" Margin="0,0,0,15"/>

                                <!-- Readiness Summary -->
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Excellent" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding ExcellentReadinessCount}" 
                                                   FontSize="20" FontWeight="Bold" Foreground="#107C10"/>
                                        <TextBlock Text="80+ score" FontSize="10" Foreground="#999"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Good" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding GoodReadinessCount}" 
                                                   FontSize="20" FontWeight="Bold" Foreground="#0078D4"/>
                                        <TextBlock Text="60-79 score" FontSize="10" Foreground="#999"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Fair" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding FairReadinessCount}" 
                                                   FontSize="20" FontWeight="Bold" Foreground="#FDB813"/>
                                        <TextBlock Text="40-59 score" FontSize="10" Foreground="#999"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="3">
                                        <TextBlock Text="Poor" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding PoorReadinessCount}" 
                                                   FontSize="20" FontWeight="Bold" Foreground="#D13438"/>
                                        <TextBlock Text="&lt;40 score" FontSize="10" Foreground="#999"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Next Batch Recommendation -->
                                <Border Background="#E3F2FD" BorderBrush="#0078D4" BorderThickness="1" 
                                        CornerRadius="6" Padding="15" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10">
                                            <Run Text="ðŸŽ¯ Next Batch Ready:"/>
                                            <Run Text="{Binding NextBatchSize, Mode=OneWay}"/>
                                            <Run Text="High-Readiness Devices"/>
                                        </TextBlock>
                                        <TextBlock FontSize="12" Foreground="#333" TextWrapping="Wrap">
                                            <Run Text="â€¢"/>
                                            <Run Text="{Binding ExcellentReadinessCount}"/>
                                            <Run Text="devices with Excellent readiness (80+ score)"/>
                                            <LineBreak/>
                                            <Run Text="â€¢"/>
                                            <Run Text="{Binding GoodReadinessCount}"/>
                                            <Run Text="devices with Good readiness (60-79 score)"/>
                                        </TextBlock>
                                        <Button Content="ðŸ“‹ Export Device List"
                                                Command="{Binding ExportDeviceListCommand}"
                                                Style="{StaticResource ActionButton}"
                                                Background="#0078D4"
                                                FontSize="12"
                                                Padding="12,6"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"/>
                                    </StackPanel>
                                </Border>

                                <!-- Barriers and Risks -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Background="#FFF9E6" BorderBrush="#FDB813" 
                                            BorderThickness="1" CornerRadius="6" Padding="12">
                                        <StackPanel>
                                            <TextBlock FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8">
                                                <Run Text="âš ï¸"/>
                                                <Run Text="{Binding DevicesNeedingPreparation}"/>
                                                <Run Text="Devices Need Preparation"/>
                                            </TextBlock>
                                            <TextBlock FontSize="11" Foreground="#666" TextWrapping="Wrap">
                                                <Run Text="Common barriers:"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Not Azure AD joined"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Offline &gt;7 days"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Legacy OS version"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="2" Background="#FFF4F4" BorderBrush="#D13438" 
                                            BorderThickness="1" CornerRadius="6" Padding="12">
                                        <StackPanel>
                                            <TextBlock FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8">
                                                <Run Text="ðŸ“‹"/>
                                                <Run Text="{Binding HighRiskDeviceCount}"/>
                                                <Run Text="Devices: Enroll Last"/>
                                            </TextBlock>
                                            <TextBlock FontSize="11" Foreground="#666" TextWrapping="Wrap">
                                                <Run Text="Risk factors:"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ VIP users"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Offline &gt;30 days"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Critical workloads"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- 5. Workload Trend Tracking (Phase 1 AI) -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“Š Workload Velocity Tracking" Style="{StaticResource SectionTitle}"/>
                                <TextBlock Text="Historical progress and migration velocity analysis" 
                                           FontSize="12" Foreground="#666666" Margin="0,0,0,15"/>

                                <!-- Velocity Chart -->
                                <lvc:CartesianChart Height="300" Series="{Binding WorkloadTrendSeries}" 
                                                    LegendLocation="Right" Margin="0,0,0,20">
                                    <lvc:CartesianChart.AxisX>
                                        <lvc:Axis Labels="{Binding WorkloadTrendLabels}" Title="Date"/>
                                    </lvc:CartesianChart.AxisX>
                                    <lvc:CartesianChart.AxisY>
                                        <lvc:Axis Title="Completion %" MinValue="0" MaxValue="100"/>
                                    </lvc:CartesianChart.AxisY>
                                </lvc:CartesianChart>

                                <!-- Velocity Indicators -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Background="#F1F8F4" BorderBrush="#107C10" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="0,0,5,0">
                                        <StackPanel>
                                            <TextBlock Text="ðŸš€ Excellent Velocity" FontWeight="SemiBold" 
                                                       FontSize="12" Foreground="#107C10" Margin="0,0,0,5"/>
                                            <TextBlock FontSize="11" Foreground="#666">
                                                <Run Text="{Binding ExcellentVelocityCount}"/>
                                                <Run Text="workloads"/>
                                                <LineBreak/>
                                                <Run Text="&gt;15% per week"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="1" Background="#FFF9E6" BorderBrush="#FDB813" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="5,0">
                                        <StackPanel>
                                            <TextBlock Text="âš¡ Good Velocity" FontWeight="SemiBold" 
                                                       FontSize="12" Foreground="#FDB813" Margin="0,0,0,5"/>
                                            <TextBlock FontSize="11" Foreground="#666">
                                                <Run Text="{Binding GoodVelocityCount}"/>
                                                <Run Text="workloads"/>
                                                <LineBreak/>
                                                <Run Text="10-15% per week"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="2" Background="#FFF4F4" BorderBrush="#D13438" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“‰ Stalled" FontWeight="SemiBold" 
                                                       FontSize="12" Foreground="#D13438" Margin="0,0,0,5"/>
                                            <TextBlock FontSize="11" Foreground="#666">
                                                <Run Text="{Binding StalledWorkloadCount}"/>
                                                <Run Text="workloads"/>
                                                <LineBreak/>
                                                <Run Text="&lt;5% per week"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- 6. Application Migration Analysis (Phase 2 Feature) -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="ðŸ“± Application Migration Analysis" Style="{StaticResource SectionTitle}" Margin="0"/>
                                        <TextBlock Text="ConfigMgr application inventory with Intune migration guidance" 
                                                   FontSize="12" Foreground="#666" Margin="0,2,0,0"/>
                                    </StackPanel>
                                    
                                    <Button Grid.Column="1" 
                                            Content="ðŸ”„ Refresh Analysis"
                                            Command="{Binding AnalyzeApplicationsCommand}"
                                            Style="{StaticResource ActionButton}"
                                            FontSize="12"
                                            Padding="12,6"/>
                                </Grid>

                                <!-- Summary Cards -->
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Background="#E8F5E9" BorderBrush="#4CAF50" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="0,0,5,0">
                                        <StackPanel>
                                            <TextBlock Text="Low Complexity" Style="{StaticResource MetricLabel}"/>
                                            <TextBlock Text="{Binding LowComplexityCount}" 
                                                       FontSize="20" FontWeight="Bold" Foreground="#4CAF50"/>
                                            <TextBlock Text="Easy migration" FontSize="10" Foreground="#666"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="1" Background="#FFF9E6" BorderBrush="#FDB813" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="5,0">
                                        <StackPanel>
                                            <TextBlock Text="Medium Complexity" Style="{StaticResource MetricLabel}"/>
                                            <TextBlock Text="{Binding MediumComplexityCount}" 
                                                       FontSize="20" FontWeight="Bold" Foreground="#FDB813"/>
                                            <TextBlock Text="Some effort needed" FontSize="10" Foreground="#666"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="2" Background="#FFF4F4" BorderBrush="#D13438" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="5,0">
                                        <StackPanel>
                                            <TextBlock Text="High Complexity" Style="{StaticResource MetricLabel}"/>
                                            <TextBlock Text="{Binding HighComplexityCount}" 
                                                       FontSize="20" FontWeight="Bold" Foreground="#D13438"/>
                                            <TextBlock Text="Requires planning" FontSize="10" Foreground="#666"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="3" Background="#E3F2FD" BorderBrush="#0078D4" 
                                            BorderThickness="1" CornerRadius="6" Padding="12" Margin="5,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="Total Apps" Style="{StaticResource MetricLabel}"/>
                                            <TextBlock Text="{Binding TotalApplicationCount}" 
                                                       FontSize="20" FontWeight="Bold" Foreground="#0078D4"/>
                                            <TextBlock Text="Analyzed" FontSize="10" Foreground="#666"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>

                                <!-- Empty State Message -->
                                <Border Background="#F5F5F5" 
                                        CornerRadius="6" 
                                        Padding="30"
                                        Margin="0,15,0,0"
                                        Visibility="{Binding ApplicationMigrations, Converter={StaticResource NullToVisibilityConverter}}">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="No applications analyzed yet" 
                                                   FontSize="14" 
                                                   FontWeight="SemiBold" 
                                                   Foreground="#666"
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,8"/>
                                        <TextBlock Text="Click 'Refresh Analysis' to analyze your ConfigMgr application inventory" 
                                                   FontSize="12" 
                                                   Foreground="#888"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                                <!-- Application List -->
                                <ItemsControl ItemsSource="{Binding ApplicationMigrations}"
                                              Visibility="{Binding ApplicationMigrations, Converter={StaticResource ObjectToVisibilityConverter}}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- App Name & Details -->
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="{Binding ApplicationName}" 
                                                                   FontWeight="SemiBold" FontSize="14"/>
                                                        <TextBlock FontSize="11" Foreground="#666" Margin="0,2,0,0">
                                                            <Run Text="Deployment:"/>
                                                            <Run Text="{Binding DeploymentType}" FontWeight="SemiBold"/>
                                                            <Run Text=" â€¢ Devices:"/>
                                                            <Run Text="{Binding TargetedDevices}" FontWeight="SemiBold"/>
                                                        </TextBlock>
                                                    </StackPanel>

                                                    <!-- Complexity Score -->
                                                    <Border Grid.Column="1" 
                                                            BorderBrush="{Binding ComplexityColor}" 
                                                            BorderThickness="2"
                                                            CornerRadius="6" 
                                                            Padding="12,6" 
                                                            Margin="10,0">
                                                        <StackPanel HorizontalAlignment="Center">
                                                            <TextBlock Text="{Binding ComplexityScore}" 
                                                                       FontSize="18" 
                                                                       FontWeight="Bold" 
                                                                       Foreground="{Binding ComplexityColor}"
                                                                       HorizontalAlignment="Center"/>
                                                            <TextBlock Text="{Binding ComplexityCategory}" 
                                                                       FontSize="9" 
                                                                       Foreground="#666"
                                                                       HorizontalAlignment="Center"/>
                                                        </StackPanel>
                                                    </Border>

                                                    <!-- Migration Path & Recommendation -->
                                                    <StackPanel Grid.Column="2" Margin="10,0">
                                                        <TextBlock Text="{Binding MigrationPath}" 
                                                                   FontSize="11" 
                                                                   FontWeight="SemiBold"
                                                                   Foreground="#0078D4"/>
                                                        <TextBlock Text="{Binding Recommendation}" 
                                                                   FontSize="10" 
                                                                   Foreground="#666" 
                                                                   TextWrapping="Wrap"
                                                                   Margin="0,2,0,0"/>
                                                    </StackPanel>

                                                    <!-- Estimated Effort -->
                                                    <Border Grid.Column="3" 
                                                            Background="#F5F5F5" 
                                                            CornerRadius="4" 
                                                            Padding="10,6"
                                                            Margin="10,0,0,0">
                                                        <StackPanel>
                                                            <TextBlock Text="â±ï¸ Effort" 
                                                                       FontSize="9" 
                                                                       Foreground="#666"
                                                                       HorizontalAlignment="Center"/>
                                                            <TextBlock Text="{Binding EstimatedEffort}" 
                                                                       FontSize="11" 
                                                                       FontWeight="SemiBold"
                                                                       HorizontalAlignment="Center"/>
                                                        </StackPanel>
                                                    </Border>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 7. Remaining Workloads (HIDDEN - Low value for admins) -->
                        <Border Style="{StaticResource SectionCard}" Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="ðŸ“‹ Workload Status" Style="{StaticResource SectionTitle}"/>
                                
                                <ItemsControl ItemsSource="{Binding Workloads}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,10">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="14"/>
                                                        <TextBlock Text="{Binding Description}" 
                                                                   FontSize="12" Foreground="#666666" 
                                                                   TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                    </StackPanel>

                                                    <Border Grid.Column="1" 
                                                            Background="{Binding Status, Converter={StaticResource WorkloadStatusConverter}}"
                                                            CornerRadius="12" Padding="10,5" Margin="10,0">
                                                        <TextBlock Text="{Binding Status}" 
                                                                   FontSize="11" Foreground="White" FontWeight="SemiBold"/>
                                                    </Border>

                                                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                        <Button Content="Start" 
                                                                Command="{Binding DataContext.StartMigrationCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                CommandParameter="{Binding Mode=OneWay}"
                                                                Style="{StaticResource ActionButton}"
                                                                Visibility="{Binding Status, Converter={StaticResource WorkloadStatusConverter}, ConverterParameter=NotStarted}"/>
                                                        <Button Content="Learn More" 
                                                                Command="{Binding DataContext.LearnMoreCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                CommandParameter="{Binding LearnMoreUrl}"
                                                                Style="{StaticResource ActionButton}"
                                                                Background="#666666"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 4. Security & Compliance Scorecard -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ”’ Security &amp; Compliance Scorecard" Style="{StaticResource SectionTitle}"/>
                                
                                <lvc:CartesianChart Height="200" Series="{Binding ComplianceComparisonSeries}" 
                                                    LegendLocation="Right" Margin="0,0,0,15">
                                    <lvc:CartesianChart.AxisX>
                                        <lvc:Axis Labels="{Binding ComplianceLabels}"/>
                                    </lvc:CartesianChart.AxisX>
                                    <lvc:CartesianChart.AxisY>
                                        <lvc:Axis Title="Compliance Score" MaxValue="100"/>
                                    </lvc:CartesianChart.AxisY>
                                </lvc:CartesianChart>

                                <TextBlock Text="Risk Areas:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ItemsControl ItemsSource="{Binding ComplianceScore.RiskAreas}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock FontSize="12" Foreground="#D13438" Margin="0,2">
                                                <Run Text="âš ï¸ "/><Run Text="{Binding Mode=OneWay}"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 6. ROI & Savings -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ’° ROI &amp; Savings Projection" Style="{StaticResource SectionTitle}" Margin="0,0,10,0"/>
                                    <Border Background="#FFA500" CornerRadius="4" Padding="6,2">
                                        <TextBlock Text="âš ï¸ ESTIMATED DATA" FontSize="11" FontWeight="Bold" Foreground="White"
                                                   ToolTip="These are industry average estimates, not your actual costs"/>
                                    </Border>
                                </StackPanel>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,15">
                                        <TextBlock Text="Estimated Annual Savings" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding ROIData.EstimatedAnnualSavings, Converter={StaticResource CurrencyConverter}}" 
                                                   Style="{StaticResource MetricValue}" Foreground="#107C10"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,15">
                                        <TextBlock Text="Infrastructure Cost Reduction" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding ROIData.InfrastructureCostReduction, Converter={StaticResource CurrencyConverter}}" 
                                                   Style="{StaticResource MetricValue}" FontSize="20"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,0">
                                        <TextBlock Text="Patch Cycle Reduction" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Style="{StaticResource MetricValue}" FontSize="20">
                                            <Run Text="{Binding ROIData.PatchCycleDaysReduced, Mode=OneWay}"/>
                                            <Run Text=" days" FontSize="14"/>
                                        </TextBlock>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,0,0,0">
                                        <TextBlock Text="Admin Time Reduction" Style="{StaticResource MetricLabel}"/>
                                        <TextBlock Text="{Binding ROIData.AdminTimeReduction, Converter={StaticResource PercentageConverter}}" 
                                                   Style="{StaticResource MetricValue}" FontSize="20"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- 9. Enrollment Readiness (True Blockers Only) -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸš« Enrollment Readiness" Style="{StaticResource SectionTitle}" Margin="0,0,10,0"/>
                                </StackPanel>
                                <TextBlock Text="Prerequisites required for Intune co-management enrollment" FontSize="11" Foreground="#666" Margin="0,0,0,10"/>
                                
                                <!-- Empty state when no blockers (ready to enroll!) -->
                                <Border Background="#E7F5E7" CornerRadius="4" Padding="20" Margin="0,10,0,0"
                                        Visibility="{Binding Blockers.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="âœ… All Prerequisites Met" FontSize="14" FontWeight="SemiBold" Foreground="#107C10" HorizontalAlignment="Center"/>
                                        <TextBlock Text="No enrollment blockers detected - ready to enroll devices" FontSize="11" Foreground="#107C10" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                                
                                <ItemsControl ItemsSource="{Binding Blockers}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#FFF3F3" CornerRadius="4" Padding="12" Margin="0,0,0,10"
                                                    BorderBrush="{Binding Severity, Converter={StaticResource BlockerSeverityConverter}}"
                                                    BorderThickness="2">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="{Binding Title}" FontWeight="SemiBold" FontSize="13"/>
                                                        <TextBlock Text="{Binding Description}" 
                                                                   FontSize="12" Foreground="#666666" 
                                                                   TextWrapping="Wrap" Margin="0,3,0,5"/>
                                                        <TextBlock Text="{Binding AffectedDevices, StringFormat='Affected devices: {0}'}" 
                                                                   FontSize="11" Foreground="#D13438" FontWeight="SemiBold"/>
                                                    </StackPanel>

                                                    <Button Grid.Column="1" Content="Fix"
                                                            Command="{Binding DataContext.LearnMoreCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding RemediationUrl}"
                                                            Style="{StaticResource ActionButton}"
                                                            Background="#D13438"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Right Column -->
                    <StackPanel Grid.Column="2">
                        <!-- 5. Peer Benchmarking -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ“ˆ Peer Benchmarking" Style="{StaticResource SectionTitle}"/>
                                
                                <TextBlock Text="{Binding PeerBenchmark.OrganizationCategory}" 
                                           FontSize="11" Foreground="#666666" Margin="0,0,0,10"/>

                                <StackPanel Margin="0,0,0,15">
                                    <TextBlock Text="Your Progress" Style="{StaticResource MetricLabel}"/>
                                    <TextBlock Text="{Binding PeerBenchmark.YourProgress, Converter={StaticResource PercentageConverter}}" 
                                               Style="{StaticResource MetricValue}" FontSize="20"/>
                                </StackPanel>

                                <TextBlock Text="You are ahead of" FontSize="12" Foreground="#666666"/>
                                <TextBlock FontSize="32" FontWeight="Bold" Foreground="#107C10" HorizontalAlignment="Center" Margin="0,5">
                                    <Run Text="{Binding PeerBenchmark.PercentileRank, Mode=OneWay}"/>
                                    <Run Text="%" FontSize="24"/>
                                </TextBlock>
                                <TextBlock Text="of similar organizations" FontSize="12" Foreground="#666666" 
                                           HorizontalAlignment="Center" Margin="0,0,0,10"/>

                                <ProgressBar Height="15" 
                                             Value="{Binding PeerBenchmark.PercentileRank}" 
                                             Maximum="100"
                                             Foreground="#107C10"/>
                            </StackPanel>
                        </Border>

                        <!-- 7. Alerts & Nudges -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ”” Alerts &amp; Recommendations" Style="{StaticResource SectionTitle}"/>
                                
                                <ItemsControl ItemsSource="{Binding Alerts}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding Severity, Converter={StaticResource AlertSeverityConverter}}"
                                                    CornerRadius="4" Padding="12" Margin="0,0,0,10">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Title}" 
                                                               FontWeight="SemiBold" FontSize="13" 
                                                               Foreground="#333333"/>
                                                    <TextBlock Text="{Binding Description}" 
                                                               FontSize="12" Foreground="#555555" 
                                                               TextWrapping="Wrap" Margin="0,5,0,10"/>
                                                    <Button Content="{Binding ActionText}" 
                                                            Command="{Binding DataContext.ActionCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="fasttrack"
                                                            Style="{StaticResource ActionButton}"
                                                            HorizontalAlignment="Left"/>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 7a. AI-Powered Recommendations (NEW v1.2.0) -->
                        <Border Style="{StaticResource SectionCard}" BorderBrush="#28a745" BorderThickness="2">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ¤– AI-Powered Recommendations" Style="{StaticResource SectionTitle}"/>
                                    <Border Background="#28a745" CornerRadius="3" Padding="5,2" Margin="10,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="NEW v1.2.0" FontSize="10" FontWeight="Bold" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                                
                                <TextBlock Text="Intelligent guidance based on YOUR migration state" 
                                           FontSize="12" Foreground="#666" Margin="0,0,0,15" TextWrapping="Wrap"/>
                                
                                <ItemsControl ItemsSource="{Binding AIRecommendations}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#E0E0E0" BorderThickness="1"
                                                    CornerRadius="5" Padding="15" Margin="0,0,0,15">
                                                <StackPanel>
                                                    <!-- Priority Badge + Title -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <Border Background="{Binding Priority, Converter={StaticResource RecommendationPriorityConverter}}"
                                                                CornerRadius="3" Padding="6,3" Margin="0,0,10,0">
                                                            <TextBlock Text="{Binding Priority}" 
                                                                       FontSize="10" FontWeight="Bold" Foreground="White"/>
                                                        </Border>
                                                        <Border Background="#E3F2FD" CornerRadius="3" Padding="6,3">
                                                            <TextBlock Text="{Binding Category}" 
                                                                       FontSize="10" Foreground="#0078D4"/>
                                                        </Border>
                                                    </StackPanel>
                                                    
                                                    <!-- Recommendation Title -->
                                                    <TextBlock Text="{Binding Title}" 
                                                               FontWeight="Bold" FontSize="14" 
                                                               Foreground="#333" Margin="0,0,0,8" TextWrapping="Wrap"/>
                                                    
                                                    <!-- Description -->
                                                    <TextBlock Text="{Binding Description}" 
                                                               FontSize="12" Foreground="#555" 
                                                               TextWrapping="Wrap" Margin="0,0,0,10"/>
                                                    
                                                    <!-- Rationale -->
                                                    <Border Background="#FFF9E6" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                                                        <StackPanel>
                                                            <TextBlock Text="ðŸ’¡ Why This Matters:" 
                                                                       FontWeight="SemiBold" FontSize="11" 
                                                                       Foreground="#856404" Margin="0,0,0,5"/>
                                                            <TextBlock Text="{Binding Rationale}" 
                                                                       FontSize="11" Foreground="#856404" 
                                                                       TextWrapping="Wrap"/>
                                                        </StackPanel>
                                                    </Border>
                                                    
                                                    <!-- Action Steps -->
                                                    <TextBlock Text="âœ… Action Steps:" 
                                                               FontWeight="SemiBold" FontSize="11" 
                                                               Foreground="#333" Margin="0,0,0,5"/>
                                                    <ItemsControl ItemsSource="{Binding ActionSteps}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding}" 
                                                                           FontSize="11" Foreground="#555" 
                                                                           TextWrapping="Wrap" Margin="0,2,0,2"/>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                    
                                                    <!-- Effort + Impact -->
                                                    <Grid Margin="0,10,0,10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <StackPanel Grid.Column="0">
                                                            <TextBlock Text="â±ï¸ Estimated Effort:" FontSize="10" Foreground="#666"/>
                                                            <TextBlock Text="{Binding EstimatedEffort}" FontSize="11" FontWeight="SemiBold" Foreground="#333"/>
                                                        </StackPanel>
                                                        <StackPanel Grid.Column="1">
                                                            <TextBlock Text="ðŸ’¯ Impact Score:" FontSize="10" Foreground="#666"/>
                                                            <TextBlock Text="{Binding ImpactScore, StringFormat={}{0}/100}" FontSize="11" FontWeight="SemiBold" Foreground="#0078D4"/>
                                                        </StackPanel>
                                                    </Grid>
                                                    
                                                    <!-- Resource Links -->
                                                    <ItemsControl ItemsSource="{Binding ResourceLinks}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Button Content="{Binding}" 
                                                                        Command="{Binding DataContext.OpenLinkCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                        CommandParameter="{Binding}"
                                                                        Background="#0078D4" Foreground="White"
                                                                        BorderThickness="0" Padding="10,5" Margin="0,2,5,2"
                                                                        Cursor="Hand" FontSize="10">
                                                                    <Button.Template>
                                                                        <ControlTemplate TargetType="Button">
                                                                            <Border Background="{TemplateBinding Background}" 
                                                                                    CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                            </Border>
                                                                        </ControlTemplate>
                                                                    </Button.Template>
                                                                </Button>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <WrapPanel/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <!-- No Recommendations Message -->
                                <Border Background="#D4EDDA" CornerRadius="4" Padding="15" 
                                        Visibility="{Binding HasNoRecommendations, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <StackPanel>
                                        <TextBlock Text="ðŸŽ‰ Excellent Progress!" 
                                                   FontWeight="Bold" FontSize="14" 
                                                   Foreground="#155724" Margin="0,0,0,5"/>
                                        <TextBlock Text="No critical recommendations at this time. Your migration is on track!" 
                                                   FontSize="12" Foreground="#155724" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!-- 8. Milestones -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸŽ¯ Recent Milestones" Style="{StaticResource SectionTitle}"/>
                                
                                <!-- Empty state when authenticated -->
                                <Border Background="#F0F9FF" CornerRadius="4" Padding="20" Margin="0,10,0,0"
                                        Visibility="{Binding Milestones.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸš§ No milestones yet" FontSize="14" FontWeight="SemiBold" Foreground="#666" HorizontalAlignment="Center"/>
                                        <TextBlock Text="Milestones will appear as you progress" FontSize="11" Foreground="#999" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                                
                                <ItemsControl ItemsSource="{Binding Milestones}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#F0F9FF" CornerRadius="4" Padding="12" Margin="0,0,0,10">
                                                <StackPanel>
                                                    <TextBlock FontSize="20" Text="{Binding Icon}" Margin="0,0,0,5"/>
                                                    <TextBlock Text="{Binding Title}" 
                                                               FontWeight="SemiBold" FontSize="13"/>
                                                    <TextBlock Text="{Binding Description}" 
                                                               FontSize="11" Foreground="#666666" 
                                                               TextWrapping="Wrap" Margin="0,3,0,5"/>
                                                    <TextBlock Text="{Binding AchievedDate, StringFormat='{}{0:MMM d, yyyy}'}" 
                                                               FontSize="10" Foreground="#999999"/>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- 10. Engagement Options -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="ðŸ¤ Get Help &amp; Resources" Style="{StaticResource SectionTitle}"/>
                                
                                <ItemsControl ItemsSource="{Binding EngagementOptions}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Command="{Binding DataContext.LearnMoreCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding Url}"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="White"
                                                    BorderBrush="#0078D4"
                                                    BorderThickness="2"
                                                    HorizontalContentAlignment="Left"
                                                    Margin="0,0,0,10"
                                                    Padding="15,12">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Title}" 
                                                               FontWeight="SemiBold" FontSize="13" 
                                                               Foreground="#0078D4"/>
                                                    <TextBlock Text="{Binding Description}" 
                                                               FontSize="11" Foreground="#666666" 
                                                               TextWrapping="Wrap" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Button>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </TabItem>

                <!-- ENROLLMENT MOMENTUM TAB -->
                <TabItem Header="ðŸ“± Enrollment">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <StackPanel>
                            <!-- AI Status Banner (shown when fallback to rules) -->
                            <Border Background="#FFF3CD" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                    Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="âš ï¸ AI INSIGHTS UNAVAILABLE" FontWeight="Bold" FontSize="14" Foreground="#856404"/>
                                        <TextBlock Text="Azure OpenAI is not configured or unreachable. Showing rule-based recommendations instead." 
                                                   FontSize="12" Foreground="#856404" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="ðŸ¤– Configure AI" 
                                            Command="{Binding ShowAISettingsCommand}"
                                            Style="{StaticResource ActionButton}"
                                            Background="#FF8C00"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Visual Aid: Progress Ring + Timeline -->
                            <Border Style="{StaticResource SectionCard}" Margin="0,0,0,20">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="280"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- LEFT: Progress Bar -->
                                    <Border Grid.Column="0" Background="#F8F8F8" CornerRadius="8" Padding="20">
                                        <StackPanel>
                                            <!-- Progress Header -->
                                            <Grid Margin="0,0,0,15">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="ENROLLMENT PROGRESS" FontSize="12" FontWeight="SemiBold" Foreground="#666666"/>
                                                    <TextBlock Text="Devices migrated to Intune" FontSize="11" Foreground="#999999" Margin="0,2,0,0"/>
                                                </StackPanel>
                                                <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                                    <TextBlock Text="{Binding EnrollmentProgressPercentage, StringFormat={}{0:F0}%, Mode=OneWay}" 
                                                               FontSize="32" FontWeight="Bold" Foreground="#107C10" 
                                                               HorizontalAlignment="Right"/>
                                                    <TextBlock Text="ENROLLED" FontSize="10" FontWeight="SemiBold" 
                                                               Foreground="#666666" HorizontalAlignment="Right" Margin="0,0,0,0"/>
                                                </StackPanel>
                                            </Grid>
                                            
                                            <!-- Horizontal Progress Bar -->
                                            <Border Background="#E0E0E0" CornerRadius="8" Height="35" Margin="0,0,0,20">
                                                <Grid>
                                                    <!-- Progress Fill -->
                                                    <Border CornerRadius="8" HorizontalAlignment="Left" Background="#107C10">
                                                        <Border.Width>
                                                            <MultiBinding Converter="{StaticResource PercentageToWidthConverter}">
                                                                <Binding Path="EnrollmentProgressPercentage"/>
                                                                <Binding RelativeSource="{RelativeSource AncestorType=Border}" Path="ActualWidth"/>
                                                            </MultiBinding>
                                                        </Border.Width>
                                                    </Border>
                                                    
                                                    <!-- Progress Text Overlay -->
                                                    <TextBlock FontSize="12" FontWeight="SemiBold" Foreground="White" 
                                                               VerticalAlignment="Center" HorizontalAlignment="Center">
                                                        <Run Text="{Binding DeviceEnrollment.IntuneEnrolledDevices, StringFormat='{}{0:N0}', Mode=OneWay}"/>
                                                        <Run Text=" of "/>
                                                        <Run Text="{Binding DeviceEnrollment.TotalDevices, StringFormat='{}{0:N0}', Mode=OneWay}"/>
                                                        <Run Text=" devices"/>
                                                    </TextBlock>
                                                </Grid>
                                            </Border>
                                            
                                            <!-- Metrics Summary -->
                                            <Border Background="White" CornerRadius="6" Padding="15" Margin="0,0,0,0">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="Intune" FontSize="12" Foreground="#666666"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding DeviceEnrollment.IntuneEnrolledDevices, StringFormat={}{0:N0}}" 
                                                                   FontSize="14" FontWeight="Bold" Foreground="#107C10"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,10">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="ConfigMgr Only" FontSize="12" Foreground="#666666"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding DeviceEnrollment.ConfigMgrOnlyDevices, StringFormat={}{0:N0}}" 
                                                                   FontSize="14" FontWeight="Bold" Foreground="#D83B01"/>
                                                    </Grid>
                                                    <Border Height="1" Background="#E0E0E0" Margin="0,5,0,10"/>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="Total Devices" FontSize="12" Foreground="#333333" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding DeviceEnrollment.TotalDevices, StringFormat={}{0:N0}}" 
                                                                   FontSize="14" FontWeight="Bold" Foreground="#0078D4"/>
                                                    </Grid>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- RIGHT: Timeline with Milestones + Target Controls -->
                                    <Grid Grid.Column="1" Margin="30,10,0,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="400"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Timeline Section -->
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="ðŸ“… ENROLLMENT JOURNEY" FontSize="16" FontWeight="Bold" Foreground="#333333" Margin="0,0,0,20"/>
                                        
                                        <!-- Timeline Items -->
                                        <Grid Margin="0,0,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Vertical Line (behind milestones) -->
                                            <Border Grid.Row="0" Grid.RowSpan="4" Width="3" Background="#E0E0E0" 
                                                    HorizontalAlignment="Left" Margin="16,20,0,20"/>

                                            <!-- Milestone 1: Started -->
                                            <Grid Grid.Row="0" Margin="0,0,0,25">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <Ellipse Grid.Column="0" Width="35" Height="35" Fill="#107C10" 
                                                         VerticalAlignment="Top"/>
                                                <TextBlock Grid.Column="0" Text="âœ“" FontSize="20" Foreground="White" 
                                                           FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Top"
                                                           Margin="0,5,0,0"/>
                                                
                                                <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                                    <TextBlock Text="Assessment Complete" FontSize="14" FontWeight="Bold" Foreground="#333333"/>
                                                    <TextBlock FontSize="12" Foreground="#666666" TextWrapping="Wrap" Margin="0,3,0,0">
                                                        <Run Text="Discovered"/>
                                                        <Run Text="{Binding DeviceEnrollment.TotalDevices, StringFormat=' {0:N0}', TargetNullValue=' --'}" FontWeight="SemiBold"/>
                                                        <Run Text=" devices for migration"/>
                                                    </TextBlock>
                                                    <TextBlock Text="ðŸ‘‰ View device readiness below" 
                                                               FontSize="11" Foreground="#0078D4" FontStyle="Italic" 
                                                               Margin="0,2,0,0" Cursor="Hand"/>
                                                </StackPanel>
                                            </Grid>

                                            <!-- Milestone 2: In Progress -->
                                            <Grid Grid.Row="1" Margin="0,0,0,25">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <Ellipse Grid.Column="0" Width="35" Height="35" VerticalAlignment="Top">
                                                    <Ellipse.Fill>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                            <GradientStop Color="#0078D4" Offset="0"/>
                                                            <GradientStop Color="#106EBE" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Ellipse.Fill>
                                                </Ellipse>
                                                <TextBlock Grid.Column="0" Text="â³" FontSize="18" Foreground="White" 
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                
                                                <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                                    <TextBlock FontSize="14" FontWeight="Bold" Foreground="#0078D4">
                                                        <Run Text="Active Enrollment"/>
                                                        <Run Text="{Binding EnrollmentProgressPercentage, StringFormat=' ({0:F0}%)', Mode=OneWay}" 
                                                             FontSize="13" Foreground="#666666"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="12" Foreground="#666666" TextWrapping="Wrap" Margin="0,3,0,0">
                                                        <Run Text="Enrolling devices at"/>
                                                        <Run Text="{Binding CurrentEnrollmentVelocity, StringFormat=' {0:F0}', TargetNullValue=' --', Mode=OneWay}" FontWeight="SemiBold"/>
                                                        <Run Text=" devices/week"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Grid>

                                            <!-- Milestone 3: Target (Based on AI Recommendation) -->
                                            <Grid Grid.Row="2" Margin="0,0,0,25">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <Ellipse Grid.Column="0" Width="35" Height="35" Fill="#F3F3F3" 
                                                         Stroke="#CCCCCC" StrokeThickness="2" VerticalAlignment="Top"/>
                                                <TextBlock Grid.Column="0" Text="ðŸŽ¯" FontSize="16" 
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                
                                                <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                                    <TextBlock Text="Accelerate Velocity" FontSize="14" FontWeight="Bold" Foreground="#666666"/>
                                                    <TextBlock FontSize="12" Foreground="#666666" TextWrapping="Wrap" Margin="0,3,0,0">
                                                        <Run Text="AI recommends"/>
                                                        <Run Text="{Binding RecommendedEnrollmentVelocity, StringFormat=' {0:F0}', TargetNullValue=' --', Mode=OneWay}" FontWeight="SemiBold" Foreground="#F57C00"/>
                                                        <Run Text=" devices/week to optimize completion"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Grid>

                                            <!-- Milestone 4: Completion -->
                                            <Grid Grid.Row="3" Margin="0,0,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <Ellipse Grid.Column="0" Width="35" Height="35" Fill="#F3F3F3" 
                                                         Stroke="#CCCCCC" StrokeThickness="2" VerticalAlignment="Top"/>
                                                <TextBlock Grid.Column="0" Text="ðŸ" FontSize="16" 
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                
                                                <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                                    <TextBlock Text="Migration Complete" FontSize="14" FontWeight="Bold" Foreground="#666666"/>
                                                    <TextBlock FontSize="12" Foreground="#666666" TextWrapping="Wrap" Margin="0,3,0,0">
                                                        <Run Text="Projected in"/>
                                                        <Run Text="{Binding ProjectedCompletionWeeks, StringFormat=' {0:F0}', TargetNullValue=' --', Mode=OneWay}" FontWeight="SemiBold" Foreground="#6A1B9A"/>
                                                        <Run Text=" weeks at recommended pace"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Grid>
                                        </Grid>
                                        </StackPanel>
                                        
                                        <!-- Velocity Target Controls (Right Side) -->
                                        <Border Grid.Column="1" Background="#FFF9E6" CornerRadius="8" Padding="20" Margin="20,0,0,0">
                                            <StackPanel>
                                                <TextBlock Text="âš™ï¸ ADJUST TARGET" FontSize="14" FontWeight="Bold" Foreground="#333333" Margin="0,0,0,10"/>
                                                <TextBlock Text="Set your target completion timeline:" FontSize="12" Foreground="#666666" TextWrapping="Wrap" Margin="0,0,0,15"/>
                                                
                                                <!-- Target Weeks Slider -->
                                                <StackPanel Margin="0,0,0,15">
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="Target Weeks" FontSize="12" Foreground="#666666"/>
                                                        <TextBlock Grid.Column="1" FontSize="14" FontWeight="Bold" Foreground="#F57C00">
                                                            <Run Text="{Binding TargetCompletionWeeks, Mode=OneWay, TargetNullValue='14'}"/>
                                                            <Run Text=" weeks" FontSize="11" Foreground="#666666"/>
                                                        </TextBlock>
                                                    </Grid>
                                                    <Slider Minimum="4" Maximum="52" Value="{Binding TargetCompletionWeeks, Mode=TwoWay}" 
                                                            TickFrequency="2" IsSnapToTickEnabled="True"
                                                            VerticalAlignment="Center"/>
                                                    <Grid Margin="0,5,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="4 weeks (aggressive)" FontSize="10" Foreground="#999999" HorizontalAlignment="Left"/>
                                                        <TextBlock Grid.Column="1" Text="52 weeks (relaxed)" FontSize="10" Foreground="#999999" HorizontalAlignment="Right"/>
                                                    </Grid>
                                                </StackPanel>
                                                
                                                <!-- Calculated Required Velocity -->
                                                <Border Background="White" CornerRadius="6" Padding="12" BorderBrush="#E0E0E0" BorderThickness="1">
                                                    <StackPanel>
                                                        <TextBlock Text="Required Velocity" FontSize="11" Foreground="#666666" Margin="0,0,0,5"/>
                                                        <TextBlock FontSize="18" FontWeight="Bold" Foreground="#0078D4">
                                                            <Run Text="{Binding CalculatedRequiredVelocity, Mode=OneWay, StringFormat='{}{0:F0}', TargetNullValue='--'}"/>
                                                            <Run Text=" devices/week" FontSize="12" Foreground="#666666"/>
                                                        </TextBlock>
                                                        <TextBlock FontSize="10" Foreground="#999999" Margin="0,3,0,0">
                                                            <Run Text="Based on"/>
                                                            <Run Text="{Binding DeviceEnrollment.ConfigMgrOnlyDevices, StringFormat=' {0:N0}', TargetNullValue=' --'}" FontWeight="SemiBold"/>
                                                            <Run Text=" remaining devices"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Border>
                                                
                                                <TextBlock Text="ðŸ’¡ Adjust the slider to see how different timelines affect required enrollment velocity" 
                                                           FontSize="10" Foreground="#666666" TextWrapping="Wrap" 
                                                           FontStyle="Italic" Margin="0,10,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </Grid>
                            </Border>

                            <!-- SMART ENROLLMENT MANAGEMENT (Merged Device Readiness + Agent) -->
                            <Border Style="{StaticResource SectionCard}">
                                <StackPanel>
                                    <!-- Main Header -->
                                    <TextBlock Text="ðŸŽ¯ Smart Enrollment Management" Style="{StaticResource SectionTitle}"/>
                                    <TextBlock Text="AI-powered readiness scoring with optional autonomous enrollment agent" 
                                               FontSize="12" Foreground="#666666" Margin="0,0,0,15"/>

                                    <!-- ZONE 1: READINESS DASHBOARD -->
                                    <Border Background="#F8F9FA" Padding="15" CornerRadius="6" Margin="0,0,0,15">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“Š Device Readiness Overview" FontSize="13" FontWeight="Bold" Margin="0,0,0,12"/>
                                            
                                            <!-- Readiness Summary Grid -->
                                            <Grid Margin="0,0,0,15">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="Excellent" Style="{StaticResource MetricLabel}"/>
                                                    <TextBlock FontSize="20" FontWeight="Bold" Foreground="#107C10">
                                                        <Run Text="{Binding ExcellentReadinessCount}"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="10" Foreground="#999">
                                                        <Run Text="80+ score"/>
                                                    </TextBlock>
                                                </StackPanel>

                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="Good" Style="{StaticResource MetricLabel}"/>
                                                    <TextBlock FontSize="20" FontWeight="Bold" Foreground="#0078D4">
                                                        <Run Text="{Binding GoodReadinessCount}"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="10" Foreground="#999">
                                                        <Run Text="60-79 score"/>
                                                    </TextBlock>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="Fair" Style="{StaticResource MetricLabel}"/>
                                                    <TextBlock FontSize="20" FontWeight="Bold" Foreground="#FDB813">
                                                        <Run Text="{Binding FairReadinessCount}"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="10" Foreground="#999">
                                                        <Run Text="40-59 score"/>
                                                    </TextBlock>
                                                </StackPanel>

                                                <StackPanel Grid.Column="3">
                                                    <TextBlock Text="Poor" Style="{StaticResource MetricLabel}"/>
                                                    <TextBlock FontSize="20" FontWeight="Bold" Foreground="#D13438">
                                                        <Run Text="{Binding PoorReadinessCount}"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="10" Foreground="#999">
                                                        <Run Text="&lt;40 score"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Grid>

                                            <!-- Ready for Enrollment Callout -->
                                            <Border Background="#E3F2FD" BorderBrush="#0078D4" BorderThickness="2" 
                                                    CornerRadius="6" Padding="15" Margin="0,0,0,15">
                                                <StackPanel>
                                                    <TextBlock FontWeight="Bold" FontSize="15" Margin="0,0,0,8">
                                                        <Run Text="âœ… READY FOR ENROLLMENT: "/>
                                                        <Run Text="{Binding NextBatchSize, Mode=OneWay}" Foreground="#107C10"/>
                                                        <Run Text=" devices"/>
                                                    </TextBlock>
                                                    <TextBlock FontSize="12" Foreground="#333" TextWrapping="Wrap" Margin="0,0,0,10">
                                                        <Run Text="â€¢ "/>
                                                        <Run Text="{Binding ExcellentReadinessCount}"/>
                                                        <Run Text=" Excellent (80+ score) - Immediate enrollment recommended"/>
                                                        <LineBreak/>
                                                        <Run Text="â€¢ "/>
                                                        <Run Text="{Binding GoodReadinessCount}"/>
                                                        <Run Text=" Good (60-79 score) - Low risk"/>
                                                    </TextBlock>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Button Content="ðŸ“‹ Export Device List"
                                                                Command="{Binding ExportDeviceListCommand}"
                                                                Style="{StaticResource ActionButton}"
                                                                Background="#0078D4" Foreground="White"
                                                                FontSize="12" Padding="12,6"
                                                                HorizontalAlignment="Left"/>
                                                        <TextBlock Text="ðŸ’¡ Want automated enrollment? Enable Agent below" 
                                                                   FontSize="11" FontStyle="Italic" Foreground="#0078D4"
                                                                   VerticalAlignment="Center" Margin="15,0,0,0"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>

                                            <!-- Barriers and Risks -->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="10"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0" Background="#FFF9E6" BorderBrush="#FDB813" 
                                                        BorderThickness="1" CornerRadius="6" Padding="12">
                                                    <StackPanel>
                                                        <TextBlock FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8">
                                                            <Run Text="âš ï¸ Needs Preparation: "/>
                                                            <Run Text="{Binding DevicesNeedingPreparation}"/>
                                                            <Run Text=" devices"/>
                                                        </TextBlock>
                                                        <TextBlock FontSize="11" Foreground="#666" TextWrapping="Wrap">
                                                            Fair/Poor readiness scores. Review apps, policies, and compliance before enrolling.
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Column="2" Background="#FFEBEE" BorderBrush="#D13438" 
                                                        BorderThickness="1" CornerRadius="6" Padding="12">
                                                    <StackPanel>
                                                        <TextBlock FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8">
                                                            <Run Text="ðŸ”´ High Risk: "/>
                                                            <Run Text="{Binding HighRiskDeviceCount}"/>
                                                            <Run Text=" devices"/>
                                                        </TextBlock>
                                                        <TextBlock FontSize="11" Foreground="#666" TextWrapping="Wrap">
                                                            Critical app or policy conflicts. Address blockers before enrollment.
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Border>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- ZONE 2: AUTONOMOUS AGENT -->
                                    <Grid Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="ðŸ¤– Autonomous Enrollment Agent" FontSize="13" FontWeight="Bold" Margin="0"/>
                                            <TextBlock Text="Let AI orchestrate enrollment from ready devices above" 
                                                       FontSize="11" Foreground="#666666" Margin="0,3,0,0"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="Phase 1: Supervised" FontSize="11" FontWeight="Bold" Foreground="#0078D4" 
                                                       VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <ToggleButton x:Name="AgentModeToggle" 
                                                          Width="50" Height="26" 
                                                          Style="{StaticResource ToggleSwitchStyle}"
                                                          ToolTip="Enable/Disable Enrollment Agent"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Configuration Panel (Collapsed when disabled) -->
                                    <Border Background="#F8F9FA" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                            Visibility="{Binding IsChecked, ElementName=AgentModeToggle, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock FontSize="12" Foreground="#0078D4" Margin="0,0,0,10" TextWrapping="Wrap">
                                                <Run Text="ðŸ“Š Agent will work with the "/>
                                                <Run Text="{Binding NextBatchSize, Mode=OneWay}" FontWeight="Bold"/>
                                                <Run Text=" ready devices from readiness analysis above"/>
                                            </TextBlock>
                                            
                                            <TextBlock Text="âš™ï¸ Configuration" FontSize="13" FontWeight="Bold" Margin="0,5,0,10"/>
                                            
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <!-- Target Date -->
                                                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,10">
                                                    <TextBlock Text="Target Completion Date" FontSize="11" Foreground="#666666" Margin="0,0,0,3"/>
                                                    <DatePicker x:Name="TargetDatePicker" 
                                                                SelectedDate="{Binding TargetCompletionDate}"
                                                                SelectedDateChanged="TargetDatePicker_SelectedDateChanged"
                                                                FontSize="12" Width="200" HorizontalAlignment="Left"/>
                                                </StackPanel>

                                                <!-- Risk Tolerance -->
                                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,10">
                                                    <TextBlock Text="Risk Tolerance" FontSize="11" Foreground="#666666" Margin="0,0,0,3"/>
                                                    <ComboBox x:Name="RiskToleranceCombo" Width="200" HorizontalAlignment="Left" FontSize="12"
                                                              SelectedIndex="0"
                                                              ToolTip="Conservative: Only devices with score â‰¥60, max 25/batch, pause at 15% failure&#x0a;Balanced: Devices with score â‰¥50, max 50/batch, pause at 20% failure&#x0a;Aggressive: AI decides eligibility, max 100/batch, pause at 30% failure">
                                                        <ComboBoxItem Content="ðŸ›¡ï¸ Conservative (Recommended)" Tag="Conservative"/>
                                                        <ComboBoxItem Content="âš–ï¸ Balanced" Tag="Balanced" IsEnabled="False" ToolTip="Phase 2 feature"/>
                                                        <ComboBoxItem Content="ðŸš€ Aggressive" Tag="Aggressive" IsEnabled="False" ToolTip="Phase 3 feature"/>
                                                    </ComboBox>
                                                </StackPanel>

                                                <!-- Max Devices Per Day -->
                                                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,10">
                                                    <TextBlock Text="Max Devices Per Day" FontSize="11" Foreground="#666666" Margin="0,0,0,3"/>
                                                    <TextBox x:Name="MaxDevicesPerDayText" Width="200" HorizontalAlignment="Left" FontSize="12"
                                                             Text="50" 
                                                             ToolTip="Auto-calculated based on target date. Edit to override AI suggestion."/>
                                                </StackPanel>

                                                <!-- Operating Hours -->
                                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,0,0,10">
                                                    <TextBlock Text="Operating Hours" FontSize="11" Foreground="#666666" Margin="0,0,0,3"/>
                                                    <ComboBox x:Name="OperatingHoursCombo" Width="200" HorizontalAlignment="Left" FontSize="12"
                                                              SelectedIndex="0"
                                                              ToolTip="Business Hours: 8AM-6PM Monday-Friday&#x0a;Extended: 6AM-10PM Monday-Saturday&#x0a;Always: 24/7 continuous operation">
                                                        <ComboBoxItem Content="â° Business Hours (8AM-6PM)" Tag="BusinessHours"/>
                                                        <ComboBoxItem Content="ðŸŒ† Extended (6AM-10PM)" Tag="Extended"/>
                                                        <ComboBoxItem Content="ðŸŒ Always (24/7)" Tag="Always"/>
                                                    </ComboBox>
                                                </StackPanel>

                                                <!-- Action Buttons -->
                                                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,10,0,0">
                                                    <Button Content="âœ¨ Generate Plan" 
                                                            Style="{StaticResource ActionButton}"
                                                            Background="#0078D4" Foreground="White"
                                                            Width="140" Height="32"
                                                            Command="{Binding GenerateAgentPlanCommand}"
                                                            IsEnabled="{Binding IsAgentRunning, Converter={StaticResource InverseBoolConverter}}"
                                                            ToolTip="Let AI create an enrollment plan"/>
                                                    <Button Content="ðŸ’¾ Save Configuration" 
                                                            Style="{StaticResource ActionButton}"
                                                            Width="140" Height="32" Margin="10,0,0,0"
                                                            Command="{Binding SaveAgentConfigCommand}"
                                                            ToolTip="Save these settings for future use"/>
                                                    <Button Content="ðŸ“‚ View Memory" 
                                                            Style="{StaticResource ActionButton}"
                                                            Width="120" Height="32" Margin="10,0,0,0"
                                                            Command="{Binding ViewAgentMemoryCommand}"
                                                            ToolTip="Open agent memory folder"/>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>

                                    <!-- Status Display -->
                                    <Border Background="#E8F4FD" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                            Visibility="{Binding IsChecked, ElementName=AgentModeToggle, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Status Icon -->
                                            <Border Grid.Column="0" Width="50" Height="50" CornerRadius="25" Margin="0,0,15,0">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="#0078D4"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsAgentRunning}" Value="True">
                                                                <Setter Property="Background" Value="#107C10"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text" Value="âš™ï¸"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsAgentRunning}" Value="True">
                                                                    <Setter Property="Text" Value="ðŸ¤–"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Border>

                                            <!-- Status Info -->
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock FontSize="14" FontWeight="Bold">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text" Value="Ready to Generate Plan"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsAgentRunning}" Value="True">
                                                                    <Setter Property="Text" Value="Agent Running"/>
                                                                    <Setter Property="Foreground" Value="#107C10"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                                <TextBlock FontSize="11" Foreground="#666666" Margin="0,3,0,0" TextWrapping="Wrap">
                                                    <Run Text="{Binding AgentStatus}"/>
                                                </TextBlock>
                                            </StackPanel>

                                            <!-- Emergency Stop -->
                                            <Button Grid.Column="2" Content="ðŸ›‘ STOP" 
                                                    Background="#D13438" Foreground="White"
                                                    FontWeight="Bold" FontSize="13"
                                                    Width="120" Height="40"
                                                    Command="{Binding StopAgentCommand}"
                                                    Visibility="{Binding IsAgentRunning, Converter={StaticResource BoolToVisibilityConverter}}"
                                                    ToolTip="Immediately halt all agent operations"/>
                                        </Grid>
                                    </Border>

                                    <!-- ZONE 3: AGENT REASONING & EXECUTION -->
                                    <!-- Agent Reasoning Panel (Shows thinking process) -->
                                    <Border Background="White" BorderBrush="#CCCCCC" BorderThickness="1" 
                                            Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                            Visibility="{Binding IsAgentRunning, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ§  Agent Reasoning" FontSize="13" FontWeight="Bold" Margin="0,0,0,10"/>
                                            
                                            <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl ItemsSource="{Binding AgentReasoningSteps}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Background="#F8F9FA" Padding="10" Margin="0,0,0,8" CornerRadius="4">
                                                                <StackPanel>
                                                                    <!-- Step Header -->
                                                                    <TextBlock FontSize="11" FontWeight="Bold" Margin="0,0,0,5">
                                                                        <Run Text="Step "/>
                                                                        <Run Text="{Binding StepNumber}"/>
                                                                        <Run Text=" - "/>
                                                                        <Run Text="{Binding Thought}" Foreground="#0078D4"/>
                                                                    </TextBlock>
                                                                    
                                                                    <!-- Tool Called -->
                                                                    <TextBlock FontSize="11" Margin="0,0,0,3" Visibility="{Binding ToolToUse, Converter={StaticResource NullToVisibilityConverter}}">
                                                                        <Run Text="ðŸ”§ Tool: " FontWeight="SemiBold"/>
                                                                        <Run Text="{Binding ToolToUse}" Foreground="#107C10"/>
                                                                    </TextBlock>
                                                                    
                                                                    <!-- Observation -->
                                                                    <TextBlock Text="{Binding Observation.Data}" FontSize="10" Foreground="#666666" 
                                                                               TextWrapping="Wrap" Margin="0,0,0,3"
                                                                               Visibility="{Binding Observation, Converter={StaticResource NullToVisibilityConverter}}"/>
                                                                    
                                                                    <!-- Reflection -->
                                                                    <TextBlock FontSize="10" Margin="0,3,0,0" 
                                                                               Visibility="{Binding Reflection, Converter={StaticResource NullToVisibilityConverter}}">
                                                                        <Run Text="ðŸ’­ " FontStyle="Italic"/>
                                                                        <Run Text="{Binding Reflection}" FontStyle="Italic" Foreground="#856404"/>
                                                                    </TextBlock>
                                                                </StackPanel>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </StackPanel>
                                    </Border>

                                    <!-- Progress Display (Visible during execution) -->
                                    <Border Background="White" BorderBrush="#CCCCCC" BorderThickness="1" 
                                            Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                            Visibility="{Binding IsAgentRunning, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“ˆ Enrollment Progress" FontSize="13" FontWeight="Bold" Margin="0,0,0,10"/>
                                            
                                            <!-- Progress Bar -->
                                            <Grid Margin="0,0,0,10">
                                                <ProgressBar Height="30" Value="0" Maximum="100"/>
                                                <TextBlock Text="0% Complete (0 / 0 devices)" 
                                                           FontSize="11" Foreground="White" FontWeight="Bold"
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>

                                            <!-- Stats Grid -->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="âœ… Enrolled" FontSize="11" Foreground="#107C10" FontWeight="Bold"/>
                                                    <TextBlock Text="0" FontSize="18" FontWeight="Bold" Margin="0,3,0,0"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="âŒ Failed" FontSize="11" Foreground="#D13438" FontWeight="Bold"/>
                                                    <TextBlock Text="0" FontSize="18" FontWeight="Bold" Margin="0,3,0,0"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="â³ Pending" FontSize="11" Foreground="#FF8C00" FontWeight="Bold"/>
                                                    <TextBlock Text="0" FontSize="18" FontWeight="Bold" Margin="0,3,0,0"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="3">
                                                    <TextBlock Text="ðŸ“ˆ Success Rate" FontSize="11" Foreground="#0078D4" FontWeight="Bold"/>
                                                    <TextBlock Text="0%" FontSize="18" FontWeight="Bold" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Grid>

                                            <!-- Current Batch -->
                                            <TextBlock Text="Current: Batch 1 of 5" FontSize="11" Foreground="#666666" Margin="0,10,0,0"/>
                                            <TextBlock Text="Next batch scheduled: Tomorrow at 9:00 AM" FontSize="11" Foreground="#666666" Margin="0,3,0,0"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Info Footer -->
                                    <Border Background="#FFF8E1" Padding="12" CornerRadius="4" Margin="0,15,0,0"
                                            Visibility="{Binding IsChecked, ElementName=AgentModeToggle, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock FontSize="11" Foreground="#856404">
                                                <Run Text="â„¹ï¸ Phase 1: Supervised Agent"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Agent plans require your approval before execution"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Emergency stop available at all times"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Agent pauses if failure rate exceeds 15%"/>
                                                <LineBreak/>
                                                <Run Text="â€¢ Complete audit trail of all agent actions"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- WORKLOAD MOMENTUM TAB -->
                <TabItem Header="ðŸ”„ Workloads">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <StackPanel>
                            <!-- AI Status Banner -->
                            <Border Background="#FFF3CD" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                    Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="âš ï¸ AI INSIGHTS UNAVAILABLE" FontWeight="Bold" FontSize="14" Foreground="#856404"/>
                                        <TextBlock Text="Azure OpenAI is not configured or unreachable. Showing rule-based recommendations instead." 
                                                   FontSize="12" Foreground="#856404" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="ðŸ¤– Configure AI" 
                                            Command="{Binding ShowAISettingsCommand}"
                                            Style="{StaticResource ActionButton}"
                                            Background="#FF8C00"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Workload Momentum Content -->
                            <Border Style="{StaticResource SectionCard}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="ðŸ”„ WORKLOAD MOMENTUM" Style="{StaticResource SectionTitle}" Margin="0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="ðŸ¤– AI-Powered" FontSize="11" FontWeight="Bold" Foreground="#107C10" 
                                                       VerticalAlignment="Center" Margin="0,0,10,0"
                                                       Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            <TextBlock Text="âš™ï¸ Rule-Based" FontSize="11" FontWeight="Bold" Foreground="#FF8C00" 
                                                       VerticalAlignment="Center"
                                                       Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Workload Recommendation (Loaded from Service) -->
                                    <StackPanel Visibility="{Binding WorkloadMomentumInsight, Converter={StaticResource NullToVisibilityConverter}}">
                                        <!-- Recommended Workload -->
                                        <Border Background="#E3F2FD" Padding="20" CornerRadius="4" Margin="0,0,0,15">
                                            <StackPanel>
                                                <TextBlock Text="ðŸŽ¯ NEXT RECOMMENDED WORKLOAD" FontSize="12" FontWeight="Bold" Foreground="#1565C0" Margin="0,0,0,10"/>
                                                <TextBlock Text="{Binding WorkloadMomentumInsight.RecommendedWorkload}" 
                                                           FontSize="24" FontWeight="Bold" Foreground="#0D47A1" TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding WorkloadMomentumInsight.Reasoning}" 
                                                           FontSize="14" Foreground="#666666" TextWrapping="Wrap" Margin="0,10,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Readiness Summary -->
                                        <Grid Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Border Grid.Column="0" Background="#F3F3F3" Padding="15" CornerRadius="4" Margin="0,0,7,0">
                                                <StackPanel>
                                                    <TextBlock Text="READINESS SCORE" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                    <TextBlock FontSize="28" FontWeight="Bold">
                                                        <Run Text="{Binding WorkloadMomentumInsight.ReadinessScore, StringFormat={}{0:F0}}" Foreground="#107C10"/>
                                                        <Run Text="/100" FontSize="16" Foreground="#999999"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Border>

                                            <Border Grid.Column="1" Background="#F3F3F3" Padding="15" CornerRadius="4" Margin="7,0,7,0">
                                                <StackPanel>
                                                    <TextBlock Text="ESTIMATED EFFORT" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                    <TextBlock Text="{Binding WorkloadMomentumInsight.EstimatedEffort}" 
                                                               FontSize="18" FontWeight="Bold" Foreground="#0078D4"/>
                                                </StackPanel>
                                            </Border>

                                            <Border Grid.Column="2" Background="#F3F3F3" Padding="15" CornerRadius="4" Margin="7,0,0,0">
                                                <StackPanel>
                                                    <TextBlock Text="RISK LEVEL" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                    <TextBlock Text="{Binding WorkloadMomentumInsight.RiskLevel}" 
                                                               FontSize="18" FontWeight="Bold" Foreground="#D83B01"/>
                                                </StackPanel>
                                            </Border>
                                        </Grid>

                                        <!-- Transition Steps -->
                                        <Border Background="#FFFAF0" Padding="15" CornerRadius="4" Margin="0,0,0,15">
                                            <StackPanel>
                                                <TextBlock Text="ðŸ“‹ TRANSITION STEPS" FontSize="12" FontWeight="Bold" Foreground="#856404" Margin="0,0,0,10"/>
                                                <ItemsControl ItemsSource="{Binding WorkloadMomentumInsight.Steps}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Margin="0,0,0,8">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="âœ“" FontSize="14" Foreground="#107C10" Margin="0,0,10,0"/>
                                                                <TextBlock Grid.Column="1" Text="{Binding}" FontSize="13" Foreground="#333333" TextWrapping="Wrap"/>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </StackPanel>
                                        </Border>

                                        <!-- Prerequisites -->
                                        <Border Background="#FFF3CD" Padding="15" CornerRadius="4" 
                                                Visibility="{Binding WorkloadMomentumInsight.Prerequisites, Converter={StaticResource CollectionToVisibilityConverter}}">
                                            <StackPanel>
                                                <TextBlock Text="âš ï¸ PREREQUISITES" FontSize="12" FontWeight="Bold" Foreground="#856404" Margin="0,0,0,10"/>
                                                <ItemsControl ItemsSource="{Binding WorkloadMomentumInsight.Prerequisites}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Margin="0,0,0,8">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="â€¢" FontSize="14" Foreground="#856404" Margin="0,0,10,0"/>
                                                                <TextBlock Grid.Column="1" Text="{Binding}" FontSize="13" Foreground="#333333" TextWrapping="Wrap"/>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>

                                    <!-- No Insights Yet -->
                                    <Border Background="#F3F3F3" Padding="30" CornerRadius="4"
                                            Visibility="{Binding WorkloadMomentumInsight, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Inverse}">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="ðŸ”„ Loading workload recommendation..." 
                                                       FontSize="14" FontWeight="Bold" Foreground="#666666" 
                                                       HorizontalAlignment="Center"/>
                                            <TextBlock Text="AI is analyzing your workload status and readiness" 
                                                       FontSize="12" Foreground="#999999" 
                                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- APPLICATIONS TAB -->
                <TabItem Header="ðŸ“¦ Applications">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <StackPanel>
                            <!-- AI Status Banner -->
                            <Border Background="#FFF3CD" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                    Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="âš ï¸ AI INSIGHTS UNAVAILABLE" FontWeight="Bold" FontSize="14" Foreground="#856404"/>
                                        <TextBlock Text="Azure OpenAI is not configured or unreachable. Showing rule-based recommendations instead." 
                                                   FontSize="12" Foreground="#856404" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="ðŸ¤– Configure AI" 
                                            Command="{Binding ShowAISettingsCommand}"
                                            Style="{StaticResource ActionButton}"
                                            Background="#FF8C00"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Applications Content -->
                            <Border Style="{StaticResource SectionCard}">
                                <StackPanel>
                                    <Grid Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="ðŸ“¦ APPLICATION MIGRATION" Style="{StaticResource SectionTitle}" Margin="0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="ðŸ¤– AI-Powered" FontSize="11" FontWeight="Bold" Foreground="#107C10" 
                                                       VerticalAlignment="Center" Margin="0,0,10,0"
                                                       Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            <TextBlock Text="âš™ï¸ Rule-Based" FontSize="11" FontWeight="Bold" Foreground="#FF8C00" 
                                                       VerticalAlignment="Center"
                                                       Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Application Summary -->
                                    <Grid Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Border Grid.Column="0" Background="#F3F3F3" Padding="15" CornerRadius="4" Margin="0,0,7,0">
                                            <StackPanel>
                                                <TextBlock Text="TOTAL APPS" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                <TextBlock Text="{Binding TotalApplicationCount}" 
                                                           FontSize="32" FontWeight="Bold" Foreground="#0078D4"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="1" Background="#E8F5E9" Padding="15" CornerRadius="4" Margin="7,0,7,0">
                                            <StackPanel>
                                                <TextBlock Text="LOW COMPLEXITY" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                <TextBlock Text="{Binding LowComplexityCount}" 
                                                           FontSize="32" FontWeight="Bold" Foreground="#107C10"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="2" Background="#FFF8E1" Padding="15" CornerRadius="4" Margin="7,0,7,0">
                                            <StackPanel>
                                                <TextBlock Text="MEDIUM COMPLEXITY" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                <TextBlock Text="{Binding MediumComplexityCount}" 
                                                           FontSize="32" FontWeight="Bold" Foreground="#FF8C00"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Grid.Column="3" Background="#FFEBEE" Padding="15" CornerRadius="4" Margin="7,0,0,0">
                                            <StackPanel>
                                                <TextBlock Text="HIGH COMPLEXITY" FontSize="11" FontWeight="Bold" Foreground="#666666" Margin="0,0,0,5"/>
                                                <TextBlock Text="{Binding HighComplexityCount}" 
                                                           FontSize="32" FontWeight="Bold" Foreground="#D83B01"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>

                                    <!-- Application List -->
                                    <ItemsControl ItemsSource="{Binding ApplicationMigrations}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#F9F9F9" Padding="15" CornerRadius="4" Margin="0,0,0,10">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>

                                                        <!-- App Name and Complexity -->
                                                        <Grid Grid.Row="0" Margin="0,0,0,10">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>

                                                            <TextBlock Grid.Column="0" Text="{Binding ApplicationName}" 
                                                                       FontSize="16" FontWeight="Bold" Foreground="#333333"/>

                                                            <Border Grid.Column="1" Padding="8,4" CornerRadius="3" Margin="10,0,0,0">
                                                                <Border.Style>
                                                                    <Style TargetType="Border">
                                                                        <Setter Property="Background" Value="#E8F5E9"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding MigrationPath}" Value="IntuneWin">
                                                                                <Setter Property="Background" Value="#FFF8E1"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding MigrationPath}" Value="RequiresReengineering">
                                                                                <Setter Property="Background" Value="#FFEBEE"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>
                                                                <TextBlock FontSize="11" FontWeight="Bold">
                                                                    <TextBlock.Style>
                                                                        <Style TargetType="TextBlock">
                                                                            <Setter Property="Foreground" Value="#107C10"/>
                                                                            <Setter Property="Text" Value="âœ“ Easy Migration"/>
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding MigrationPath}" Value="IntuneWin">
                                                                                    <Setter Property="Foreground" Value="#FF8C00"/>
                                                                                    <Setter Property="Text" Value="âš™ï¸ Package Required"/>
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding MigrationPath}" Value="RequiresReengineering">
                                                                                    <Setter Property="Foreground" Value="#D83B01"/>
                                                                                    <Setter Property="Text" Value="âš ï¸ Complex"/>
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </TextBlock.Style>
                                                                </TextBlock>
                                                            </Border>
                                                        </Grid>

                                                        <!-- Metadata -->
                                                        <Grid Grid.Row="1" Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>

                                                            <TextBlock Grid.Column="0" Margin="0,0,15,0">
                                                                <Run Text="Type: " Foreground="#999999"/>
                                                                <Run Text="{Binding DeploymentType}" FontWeight="Bold" Foreground="#666666"/>
                                                            </TextBlock>

                                                            <TextBlock Grid.Column="1" Margin="0,0,15,0">
                                                                <Run Text="Devices: " Foreground="#999999"/>
                                                                <Run Text="{Binding TargetedDevices}" FontWeight="Bold" Foreground="#666666"/>
                                                            </TextBlock>

                                                            <TextBlock Grid.Column="2">
                                                                <Run Text="Effort: " Foreground="#999999"/>
                                                                <Run Text="{Binding EstimatedEffort}" FontWeight="Bold" Foreground="#666666"/>
                                                            </TextBlock>
                                                        </Grid>

                                                        <!-- Recommendation -->
                                                        <TextBlock Grid.Row="2" Text="{Binding Recommendation}" 
                                                                   FontSize="13" Foreground="#333333" TextWrapping="Wrap" Margin="0,0,0,8"/>

                                                        <!-- Complexity Score Bar -->
                                                        <Grid Grid.Row="3">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>

                                                            <TextBlock Grid.Column="0" Text="Complexity:" FontSize="11" Foreground="#999999" Margin="0,0,10,0"/>

                                                            <ProgressBar Grid.Column="1" Height="8" 
                                                                         Value="{Binding ComplexityScore}" Maximum="100"
                                                                         VerticalAlignment="Center">
                                                                <ProgressBar.Style>
                                                                    <Style TargetType="ProgressBar">
                                                                        <Setter Property="Foreground" Value="#107C10"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding ComplexityScore}" Value="30">
                                                                                <Setter Property="Foreground" Value="#FF8C00"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding ComplexityScore}" Value="60">
                                                                                <Setter Property="Foreground" Value="#D83B01"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </ProgressBar.Style>
                                                            </ProgressBar>
                                                        </Grid>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <!-- Empty State -->
                                    <Border Background="#F3F3F3" Padding="30" CornerRadius="4"
                                            Visibility="{Binding ApplicationMigrations, Converter={StaticResource CollectionToVisibilityConverter}, ConverterParameter=Inverse}">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="ðŸ“¦ No applications to analyze" 
                                                       FontSize="14" FontWeight="Bold" Foreground="#666666" 
                                                       HorizontalAlignment="Center"/>
                                            <TextBlock Text="Connect to ConfigMgr to scan application inventory" 
                                                       FontSize="12" Foreground="#999999" 
                                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- EXECUTIVE DASHBOARD TAB -->
                <TabItem Header="ðŸ“Š Executive">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <StackPanel>
                            <!-- AI Status Banner -->
                            <Border Background="#FFF3CD" Padding="15" CornerRadius="4" Margin="0,0,0,15"
                                    Visibility="{Binding IsAIAvailable, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="âš ï¸ AI INSIGHTS UNAVAILABLE" FontWeight="Bold" FontSize="14" Foreground="#856404"/>
                                        <TextBlock Text="Azure OpenAI is not configured or unreachable. Showing rule-based recommendations instead." 
                                                   FontSize="12" Foreground="#856404" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="ðŸ¤– Configure AI" 
                                            Command="{Binding ShowAISettingsCommand}"
                                            Style="{StaticResource ActionButton}"
                                            Background="#FF8C00"
                                            VerticalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Executive Summary Content -->
                            <StackPanel Visibility="{Binding ExecutiveSummary, Converter={StaticResource NullToVisibilityConverter}}">
                                <!-- Migration Health Score Card -->
                                <Border Background="#E3F2FD" Padding="30" CornerRadius="4" Margin="0,0,0,15">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="MIGRATION HEALTH SCORE" 
                                                   FontSize="14" FontWeight="Bold" Foreground="#666666" 
                                                   HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding ExecutiveSummary.MigrationHealthScore, StringFormat={}{0:F0}}" 
                                                       FontSize="72" FontWeight="Bold" Foreground="#0078D4"/>
                                            <TextBlock Text="/100" FontSize="36" FontWeight="Bold" Foreground="#666666" 
                                                       VerticalAlignment="Bottom" Margin="5,0,0,10"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding ExecutiveSummary.OverallStatus}" 
                                                   FontSize="13" FontStyle="Italic" Foreground="#666666" 
                                                   HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Executive Brief -->
                                <Border Style="{StaticResource SectionCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“ EXECUTIVE BRIEF" Style="{StaticResource SectionTitle}" Margin="0,0,0,15"/>
                                        <TextBlock Text="{Binding ExecutiveSummary.ExecutiveSummaryText}" 
                                                   FontSize="14" Foreground="#333333" TextWrapping="Wrap" LineHeight="22"/>
                                    </StackPanel>
                                </Border>

                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Key Risks -->
                                    <Border Grid.Column="0" Style="{StaticResource SectionCard}" Margin="0,0,7,0">
                                        <StackPanel>
                                            <TextBlock Text="âš ï¸ KEY RISKS" Style="{StaticResource SectionTitle}" Margin="0,0,0,15"/>
                                            
                                            <ItemsControl ItemsSource="{Binding ExecutiveSummary.CriticalIssues}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="#FFEBEE" Padding="12" CornerRadius="4" Margin="0,0,0,8">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Text="âš ï¸" FontSize="16" Margin="0,0,10,0" VerticalAlignment="Top"/>
                                                                <TextBlock Grid.Column="1" Text="{Binding}" 
                                                                           FontSize="13" Foreground="#C62828" TextWrapping="Wrap"/>
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <!-- Empty State -->
                                            <Border Background="#E8F5E9" Padding="12" CornerRadius="4"
                                                    Visibility="{Binding ExecutiveSummary.CriticalIssues, Converter={StaticResource CollectionToVisibilityConverter}, ConverterParameter=Inverse}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="âœ“" FontSize="16" Foreground="#107C10" Margin="0,0,10,0"/>
                                                    <TextBlock Text="No critical risks identified" 
                                                               FontSize="13" Foreground="#107C10" FontWeight="Bold"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- Strategic Recommendations -->
                                    <Border Grid.Column="1" Style="{StaticResource SectionCard}" Margin="7,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="âœ¨ STRATEGIC RECOMMENDATIONS" Style="{StaticResource SectionTitle}" Margin="0,0,0,15"/>
                                            
                                            <ItemsControl ItemsSource="{Binding ExecutiveSummary.KeyAchievements}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid Margin="0,0,0,12">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0" Text="âœ“" FontSize="16" FontWeight="Bold" 
                                                                       Foreground="#107C10" Margin="0,0,10,0" VerticalAlignment="Top"/>
                                                            <TextBlock Grid.Column="1" Text="{Binding}" 
                                                                       FontSize="13" Foreground="#333333" TextWrapping="Wrap"/>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <!-- Empty State -->
                                            <Border Background="#F3F3F3" Padding="12" CornerRadius="4"
                                                    Visibility="{Binding ExecutiveSummary.KeyAchievements, Converter={StaticResource CollectionToVisibilityConverter}, ConverterParameter=Inverse}">
                                                <TextBlock Text="No recommendations at this time" 
                                                           FontSize="13" Foreground="#999999" FontStyle="Italic"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                </Grid>

                                <!-- Next Critical Action -->
                                <Border Style="{StaticResource SectionCard}">
                                    <StackPanel>
                                        <TextBlock Text="ðŸŽ¯ NEXT CRITICAL ACTION" 
                                                   Style="{StaticResource SectionTitle}" Margin="0,0,0,10"/>
                                        <TextBlock Text="{Binding ExecutiveSummary.NextCriticalAction}" 
                                                   FontSize="14" FontWeight="Bold" Foreground="#0078D4" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Loading State -->
                            <Border Style="{StaticResource SectionCard}"
                                    Visibility="{Binding ExecutiveSummary, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Inverse}">
                                <StackPanel HorizontalAlignment="Center" Margin="40">
                                    <TextBlock Text="ðŸ”„ Loading executive summary..." 
                                               FontSize="16" FontWeight="Bold" Foreground="#666666" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Analyzing migration status and generating insights..." 
                                               FontSize="13" Foreground="#999999" 
                                               HorizontalAlignment="Center" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</Window>
